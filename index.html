<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Western Airducts Lanka - Inventory Management</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4361ee;
            --primary-dark: #3a56d4;
            --secondary: #7209b7;
            --success: #4cc9f0;
            --warning: #f72585;
            --danger: #e63946;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --light-gray: #e9ecef;
            --sidebar-width: 250px;
            --header-height: 70px;
            --border-radius: 12px;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fb;
            color: var(--dark);
            line-height: 1.6;
            display: flex;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Sidebar Styles */
        .sidebar {
            width: var(--sidebar-width);
            background: linear-gradient(180deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            height: 100vh;
            position: fixed;
            overflow-y: auto;
            transition: var(--transition);
            z-index: 1000;
            box-shadow: var(--shadow);
        }

        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: 10px;
            position: sticky;
            top: 0;
            background: var(--primary);
            z-index: 1;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
            white-space: nowrap;
        }

        .logo i {
            font-size: 1.8rem;
            flex-shrink: 0;
        }

        .sidebar-nav {
            padding: 1rem 0;
        }

        .nav-item {
            padding: 0.8rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            color: rgba(255, 255, 255, 0.8);
            font-weight: 500;
            border-left: 4px solid transparent;
            white-space: nowrap;
        }

        .nav-item:hover, .nav-item.active {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            border-left: 4px solid white;
        }

        .nav-item i {
            width: 20px;
            text-align: center;
            flex-shrink: 0;
        }

        /* Main Content Styles */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 2rem;
            transition: var(--transition);
            width: calc(100% - var(--sidebar-width));
            min-width: 0;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--light-gray);
            flex-wrap: wrap;
            gap: 1rem;
        }

        .page-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--dark);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            flex-shrink: 0;
        }

        /* Dashboard Cards */
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .card {
            background: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border-left: 4px solid var(--primary);
            overflow: hidden;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .card-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            background-color: rgba(67, 97, 238, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
            color: var(--primary);
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .card h3 {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 0.5rem;
            font-weight: 600;
            text-overflow: ellipsis;
            overflow: hidden;
            white-space: nowrap;
        }

        .card .number {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--dark);
            text-overflow: ellipsis;
            overflow: hidden;
        }

        /* Tabs */
        .tabs {
            display: flex;
            background: white;
            border-radius: var(--border-radius);
            padding: 0.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow);
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .tabs::-webkit-scrollbar {
            display: none;
        }

        .tab {
            padding: 0.8rem 1.5rem;
            cursor: pointer;
            background: none;
            border: none;
            font-size: 0.95rem;
            color: var(--gray);
            transition: var(--transition);
            border-radius: 8px;
            white-space: nowrap;
            font-weight: 500;
            flex-shrink: 0;
        }

        .tab.active {
            background-color: var(--primary);
            color: white;
        }

        .tab-content {
            display: none;
            background: white;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            animation: fadeIn 0.3s ease;
            overflow: hidden;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Forms */
        .form-group {
            margin-bottom: 1.2rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--dark);
        }

        input, select, textarea {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 1px solid var(--light-gray);
            border-radius: 8px;
            font-size: 1rem;
            transition: var(--transition);
            background-color: white;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        button {
            padding: 0.8rem 1.5rem;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            white-space: nowrap;
            min-height: 44px;
        }

        button:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
        }

        button.secondary {
            background-color: var(--light-gray);
            color: var(--dark);
        }

        button.secondary:hover {
            background-color: #dee2e6;
        }

        button.danger {
            background-color: var(--danger);
        }

        button.danger:hover {
            background-color: #c1121f;
        }

        button.warning {
            background-color: var(--warning);
        }

        button.warning:hover {
            background-color: #d63384;
        }

        /* Tables */
        .table-container {
            overflow-x: auto;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 1rem;
            -webkit-overflow-scrolling: touch;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            min-width: 800px;
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--light-gray);
            white-space: nowrap;
        }

        th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: var(--dark);
            position: sticky;
            top: 0;
            z-index: 1;
        }

        tr:hover {
            background-color: #f8f9fa;
        }

        .status {
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
            white-space: nowrap;
        }

        .status-low {
            background-color: rgba(230, 57, 70, 0.1);
            color: var(--danger);
        }

        .status-ok {
            background-color: rgba(76, 201, 240, 0.1);
            color: var(--success);
        }

        .status-overdue {
            background-color: rgba(247, 37, 133, 0.1);
            color: var(--warning);
        }

        .status-paid {
            background-color: rgba(67, 97, 238, 0.1);
            color: var(--primary);
        }

        .action-btn {
            padding: 0.4rem 0.8rem;
            margin-right: 0.5rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 4px;
            white-space: nowrap;
        }

        .edit-btn {
            background-color: rgba(247, 37, 133, 0.1);
            color: var(--warning);
        }

        .delete-btn {
            background-color: rgba(230, 57, 70, 0.1);
            color: var(--danger);
        }

        .issue-btn {
            background-color: rgba(67, 97, 238, 0.1);
            color: var(--primary);
        }

        .view-btn {
            background-color: rgba(76, 201, 240, 0.1);
            color: var(--success);
        }

        .mail-btn {
            background-color: rgba(114, 9, 183, 0.1);
            color: var(--secondary);
        }

        /* Search and Filters */
        .search-container {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            align-items: flex-end;
        }

        .search-container .form-group {
            flex: 1;
            min-width: 200px;
            margin-bottom: 0;
        }

        .search-results-info {
            margin-bottom: 1rem;
            color: var(--gray);
            font-style: italic;
        }

        /* Alerts */
        .alert {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: fadeIn 0.3s ease;
        }

        .alert-success {
            background-color: rgba(76, 201, 240, 0.1);
            color: var(--success);
            border-left: 4px solid var(--success);
        }

        .alert-error {
            background-color: rgba(230, 57, 70, 0.1);
            color: var(--danger);
            border-left: 4px solid var(--danger);
        }

        .alert-warning {
            background-color: rgba(247, 37, 133, 0.1);
            color: var(--warning);
            border-left: 4px solid var(--warning);
        }

        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            z-index: 100;
            transition: var(--transition);
        }

        .fab:hover {
            background-color: var(--primary-dark);
            transform: scale(1.1);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            overflow-y: auto;
        }

        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: var(--border-radius);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            max-width: 600px;
            width: 100%;
            animation: modalFadeIn 0.3s ease;
            max-height: 90vh;
            overflow-y: auto;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark);
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--gray);
            cursor: pointer;
            padding: 0.5rem;
            line-height: 1;
        }

        .modal-footer {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        /* Mail Styles */
        .mail-container {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 1.5rem;
            height: 70vh;
        }

        .mail-sidebar {
            background: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .mail-content {
            background: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
        }

        .mail-list {
            flex: 1;
            overflow-y: auto;
            margin-top: 1rem;
        }

        .mail-item {
            padding: 1rem;
            border-bottom: 1px solid var(--light-gray);
            cursor: pointer;
            transition: var(--transition);
        }

        .mail-item:hover {
            background-color: #f8f9fa;
        }

        .mail-item.unread {
            font-weight: 600;
            background-color: rgba(67, 97, 238, 0.05);
        }

        .mail-item.selected {
            background-color: rgba(67, 97, 238, 0.1);
            border-left: 4px solid var(--primary);
        }

        .mail-preview {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .mail-sender {
            font-weight: 600;
            color: var(--dark);
        }

        .mail-subject {
            color: var(--dark);
            margin: 0.3rem 0;
        }

        .mail-body-preview {
            color: var(--gray);
            font-size: 0.9rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .mail-date {
            font-size: 0.8rem;
            color: var(--gray);
        }

        /* Responsive Design */
        @media (max-width: 992px) {
            .sidebar {
                width: 70px;
                overflow: visible;
            }

            .sidebar-header .logo-text, .nav-item span {
                display: none;
            }

            .nav-item {
                justify-content: center;
                padding: 1rem;
            }

            .main-content {
                margin-left: 70px;
                width: calc(100% - 70px);
                padding: 1rem;
            }

            .dashboard {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }

            .mail-container {
                grid-template-columns: 1fr;
                height: auto;
            }
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 1rem;
            }

            .dashboard {
                grid-template-columns: 1fr;
            }

            .tabs {
                flex-direction: column;
                overflow-x: visible;
            }

            .tab {
                text-align: left;
                border-bottom: 1px solid var(--light-gray);
                border-radius: 0;
                width: 100%;
            }

            .tab:first-child {
                border-radius: 8px 8px 0 0;
            }

            .tab:last-child {
                border-radius: 0 0 8px 8px;
                border-bottom: none;
            }

            .search-container {
                flex-direction: column;
            }

            .search-container .form-group {
                min-width: 100%;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .header {
                flex-direction: column;
                align-items: flex-start;
            }

            .modal-content {
                padding: 1.5rem;
            }

            .modal-footer {
                flex-direction: column;
            }

            .modal-footer button {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .card {
                padding: 1rem;
            }

            th, td {
                padding: 0.75rem 0.5rem;
            }

            .action-btn {
                margin: 2px;
                padding: 0.3rem 0.5rem;
            }

            .fab {
                bottom: 1rem;
                right: 1rem;
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }
        }

        /* Utility Classes */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .mb-1 { margin-bottom: 1rem; }
        .mb-2 { margin-bottom: 2rem; }
        .mt-1 { margin-top: 1rem; }
        .mt-2 { margin-top: 2rem; }
        .d-flex { display: flex; }
        .justify-between { justify-content: space-between; }
        .align-center { align-items: center; }
        .w-100 { width: 100%; }

        /* Currency formatting */
        .currency {
            font-family: 'Courier New', monospace;
            font-weight: 600;
        }

        /* Loading State */
        .loading {
            opacity: 0.7;
            pointer-events: none;
        }

        /* Tooltip for truncated text */
        [title] {
            position: relative;
        }

        [title]:hover::after {
            content: attr(title);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--dark);
            color: white;
            padding: 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            white-space: nowrap;
            z-index: 1000;
        }

        /* Invoice and Supplier Badges */
        .invoice-badge {
            padding: 0.3rem 0.6rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            display: inline-block;
            background-color: var(--light-gray);
            color: var(--dark);
        }

        .supplier-badge {
            padding: 0.3rem 0.6rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            display: inline-block;
            background-color: rgba(114, 9, 183, 0.1);
            color: var(--secondary);
        }

        /* Outstanding Amount Styles */
        .outstanding-amount {
            font-weight: 700;
            font-size: 1.1rem;
        }

        .outstanding-overdue {
            color: var(--danger);
        }

        .outstanding-due {
            color: var(--warning);
        }

        .outstanding-paid {
            color: var(--success);
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <i class="fas fa-boxes"></i>
                <span class="logo-text">Western Airducts</span>
            </div>
        </div>
        <nav class="sidebar-nav">
            <a href="#" class="nav-item active" data-tab="dashboard">
                <i class="fas fa-tachometer-alt"></i>
                <span>Dashboard</span>
            </a>
            <a href="#" class="nav-item" data-tab="suppliers">
                <i class="fas fa-truck"></i>
                <span>Suppliers</span>
            </a>
            <a href="#" class="nav-item" data-tab="reports">
                <i class="fas fa-chart-bar"></i>
                <span>Reports</span>
            </a>
            <a href="#" class="nav-item" data-tab="mail">
                <i class="fas fa-envelope"></i>
                <span>Mail</span>
            </a>
            <a href="#" class="nav-item" data-tab="settings">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </a>
            <a href="#" class="nav-item" id="logout-link">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
            </a>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <div class="header">
            <h1 class="page-title">Inventory Dashboard</h1>
            <div class="user-info">
                <div class="user-avatar">JD</div>
                <div>
                    <div>John Doe</div>
                    <div style="font-size: 0.8rem; color: var(--gray);">Administrator</div>
                </div>
            </div>
        </div>

        <!-- Dashboard Section -->
        <div id="dashboard-section">
            <div class="dashboard">
                <div class="card">
                    <div class="card-icon">
                        <i class="fas fa-box"></i>
                    </div>
                    <h3>Total Items</h3>
                    <div class="number" id="total-items">0</div>
                </div>
                <div class="card">
                    <div class="card-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <h3>Low Stock Items</h3>
                    <div class="number" id="low-stock">0</div>
                </div>
                <div class="card">
                    <div class="card-icon">
                        <i class="fas fa-truck-loading"></i>
                    </div>
                    <h3>Issued Today</h3>
                    <div class="number" id="issued-today">0</div>
                </div>
                <div class="card">
                    <div class="card-icon">
                        <i class="fas fa-briefcase"></i>
                    </div>
                    <h3>Active Jobs</h3>
                    <div class="number" id="active-jobs">0</div>
                </div>
                <div class="card">
                    <div class="card-icon">
                        <i class="fas fa-coins"></i>
                    </div>
                    <h3>Total Stock Value</h3>
                    <div class="number" id="">Rs. 0.00</div>
                </div>
                <div class="card">
                    <div class="card-icon">
                        <i class="fas fa-file-invoice-dollar"></i>
                    </div>
                    <h3>Supplier Outstanding</h3>
                    <div class="number" id="">Rs. 0.00</div>
                </div>
            </div>

            <div class="tabs">
                <button class="tab active" data-tab="inventory">Inventory</button>
                <button class="tab" data-tab="issue">Issue Items</button>
                <button class="tab" data-tab="jobs">Job Numbers</button>
                <button class="tab" data-tab="suppliers-tab">Suppliers & Outstanding</button>
                <button class="tab" data-tab="history">Issue History</button>
            </div>

            <!-- Inventory Tab -->
            <div class="tab-content active" id="inventory-tab">
                <div class="d-flex justify-between align-center mb-2">
                    <h2>Inventory Management</h2>
                    <button id="add-item-btn">
                        <i class="fas fa-plus"></i> Add New Item
                    </button>
                </div>
                
                <div class="alert alert-success" id="success-message" style="display: none;"></div>
                <div class="alert alert-error" id="error-message" style="display: none;"></div>
                
                <div class="search-container">
                    <div class="form-group">
                        <label for="inventory-search">Search Inventory</label>
                        <input type="text" id="inventory-search" placeholder="Search by code, name, category, supplier, or invoice...">
                    </div>
                    <div class="form-group">
                        <label for="inventory-category-filter">Filter by Category</label>
                        <select id="inventory-category-filter">
                            <option value="">All Categories</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="inventory-supplier-filter">Filter by Supplier</label>
                        <select id="inventory-supplier-filter">
                            <option value="">All Suppliers</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="inventory-status-filter">Filter by Status</label>
                        <select id="inventory-status-filter">
                            <option value="">All Status</option>
                            <option value="low">Low Stock</option>
                            <option value="ok">In Stock</option>
                        </select>
                    </div>
                    <button id="clear-inventory-search" class="secondary">
                        <i class="fas fa-times"></i> Clear
                    </button>
                </div>
                <div class="search-results-info" id="inventory-results-info"></div>
                
                <div class="table-container">
                    <table id="inventory-table">
                        <thead>
                            <tr>
                                <th>Code</th>
                                <th>Name</th>
                                <th>Category</th>
                                <th>Supplier</th>
                                <th>Invoice No</th>
                                <th>Unit</th>
                                <th>Unit Price (Rs)</th>
                                <th>Quantity</th>
                                <th>Status</th>
                                <th>Value (Rs)</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="inventory-body">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Issue Items Tab -->
            <div class="tab-content" id="issue-tab">
                <h2 class="mb-2">Issue Items to Job</h2>
                <div class="alert alert-success" id="issue-success-message" style="display: none;"></div>
                <div class="alert alert-error" id="issue-error-message" style="display: none;"></div>
                
                <div class="search-container">
                    <div class="form-group">
                        <label for="issue-item-search">Search Items</label>
                        <input type="text" id="issue-item-search" placeholder="Search items by code, name, or supplier...">
                    </div>
                    <div class="form-group">
                        <label for="issue-category-filter">Filter by Category</label>
                        <select id="issue-category-filter">
                            <option value="">All Categories</option>
                        </select>
                    </div>
                    <button id="clear-issue-search" class="secondary">
                        <i class="fas fa-times"></i> Clear
                    </button>
                </div>
                
                <form id="issueForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="job-number">Job Number</label>
                            <select id="job-number" required>
                                <option value="">Select Job Number</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="issue-item">Item</label>
                            <select id="issue-item" required>
                                <option value="">Select Item</option>
                            </select>
                            <div id="available-quantity" style="margin-top: 5px; font-size: 0.9rem; color: var(--gray);"></div>
                        </div>
                        <div class="form-group">
                            <label for="issue-quantity">Quantity to Issue</label>
                            <input type="number" id="issue-quantity" min="1" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="issue-notes">Notes (Optional)</label>
                        <textarea id="issue-notes" rows="3" placeholder="Enter any notes about this issue..."></textarea>
                    </div>
                    <button type="submit">
                        <i class="fas fa-paper-plane"></i> Issue Item
                    </button>
                </form>
            </div>

            <!-- Job Numbers Tab -->
            <div class="tab-content" id="jobs-tab">
                <div class="d-flex justify-between align-center mb-2">
                    <h2>Job Number Management</h2>
                    <button id="add-job-btn">
                        <i class="fas fa-plus"></i> Add New Job
                    </button>
                </div>
                
                <div class="alert alert-success" id="job-success-message" style="display: none;"></div>
                <div class="alert alert-error" id="job-error-message" style="display: none;"></div>
                
                <div class="search-container">
                    <div class="form-group">
                        <label for="job-search">Search Jobs</label>
                        <input type="text" id="job-search" placeholder="Search by job number or description...">
                    </div>
                    <div class="form-group">
                        <label for="job-status-filter">Filter by Status</label>
                        <select id="job-status-filter">
                            <option value="">All Status</option>
                            <option value="Active">Active</option>
                            <option value="Completed">Completed</option>
                            <option value="On Hold">On Hold</option>
                        </select>
                    </div>
                    <button id="clear-job-search" class="secondary">
                        <i class="fas fa-times"></i> Clear
                    </button>
                </div>
                <div class="search-results-info" id="job-results-info"></div>
                
                <div class="table-container">
                    <table id="jobs-table">
                        <thead>
                            <tr>
                                <th>Job Number</th>
                                <th>Description</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="jobs-body">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Suppliers & Outstanding Tab -->
            <div class="tab-content" id="suppliers-tab">
                <div class="d-flex justify-between align-center mb-2">
                    <h2>Suppliers & Outstanding Management</h2>
                    <button id="add-supplier-btn">
                        <i class="fas fa-plus"></i> Add New Supplier
                    </button>
                </div>
                
                <div class="alert alert-success" id="supplier-success-message" style="display: none;"></div>
                <div class="alert alert-error" id="supplier-error-message" style="display: none;"></div>
                
                <div class="search-container">
                    <div class="form-group">
                        <label for="supplier-search">Search Suppliers</label>
                        <input type="text" id="supplier-search" placeholder="Search by supplier name, company, or contact...">
                    </div>
                    <div class="form-group">
                        <label for="supplier-status-filter">Filter by Status</label>
                        <select id="supplier-status-filter">
                            <option value="">All Status</option>
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                            <option value="overdue">Overdue Payments</option>
                            <option value="paid">All Paid</option>
                        </select>
                    </div>
                    <button id="clear-supplier-search" class="secondary">
                        <i class="fas fa-times"></i> Clear
                    </button>
                </div>
                <div class="search-results-info" id="supplier-results-info"></div>
                
                <div class="table-container">
                    <table id="suppliers-table">
                        <thead>
                            <tr>
                                <th>Supplier ID</th>
                                <th>Company Name</th>
                                <th>Contact Person</th>
                                <th>Phone</th>
                                <th>Email</th>
                                <th>Total Outstanding</th>
                                <th>Status</th>
                                <th>Last Payment</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="suppliers-body">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Issue History Tab -->
            <div class="tab-content" id="history-tab">
                <h2 class="mb-2">Issue History</h2>
                
                <div class="search-container">
                    <div class="form-group">
                        <label for="history-search">Search History</label>
                        <input type="text" id="history-search" placeholder="Search by job number, item code, or item name...">
                    </div>
                    <div class="form-group">
                        <label for="history-date-from">From Date</label>
                        <input type="date" id="history-date-from">
                    </div>
                    <div class="form-group">
                        <label for="history-date-to">To Date</label>
                        <input type="date" id="history-date-to">
                    </div>
                    <button id="search-history">
                        <i class="fas fa-search"></i> Search
                    </button>
                    <button id="clear-history" class="secondary">
                        <i class="fas fa-times"></i> Clear
                    </button>
                </div>
                <div class="search-results-info" id="history-results-info"></div>
                
                <div class="table-container">
                    <table id="history-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Job Number</th>
                                <th>Item Code</th>
                                <th>Item Name</th>
                                <th>Quantity</th>
                                <th>Issued By</th>
                                <th>Notes</th>
                            </tr>
                        </thead>
                        <tbody id="history-body">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Suppliers Section -->
        <div id="suppliers-section" style="display: none;">
            <h2 class="mb-2">Supplier Management</h2>
            
            <div class="card mb-2">
                <h3 class="mb-1">Supplier Directory</h3>
                <div class="search-container">
                    <div class="form-group">
                        <label for="supplier-directory-search">Search Suppliers</label>
                        <input type="text" id="supplier-directory-search" placeholder="Search suppliers...">
                    </div>
                    <button id="add-supplier-directory-btn" class="secondary">
                        <i class="fas fa-plus"></i> Add Supplier
                    </button>
                </div>
                
                <div class="table-container">
                    <table id="supplier-directory-table">
                        <thead>
                            <tr>
                                <th>Supplier Code</th>
                                <th>Company</th>
                                <th>Contact</th>
                                <th>Phone</th>
                                <th>Email</th>
                                <th>Items Supplied</th>
                                <th>Total Transactions</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="supplier-directory-body">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="card">
                <h3 class="mb-1">Supplier Performance</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="supplier-performance-period">Select Period</label>
                        <select id="supplier-performance-period">
                            <option value="30">Last 30 Days</option>
                            <option value="90">Last 90 Days</option>
                            <option value="365">Last Year</option>
                            <option value="all">All Time</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="supplier-performance-metric">Metric</label>
                        <select id="supplier-performance-metric">
                            <option value="delivery">Delivery Time</option>
                            <option value="quality">Quality Rating</option>
                            <option value="price">Price Competitiveness</option>
                            <option value="total">Total Value</option>
                        </select>
                    </div>
                </div>
                <div id="supplier-performance-chart" style="height: 300px; margin: 20px 0; position: relative;">
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: var(--gray); text-align: center;">
                        <i class="fas fa-chart-line" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                        <p>Supplier performance chart will be displayed here</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Reports Section -->
        <div id="reports-section" style="display: none;">
            <h2 class="mb-2">Reports & Analytics</h2>
            
            <div class="card mb-2">
                <div class="form-row">
                    <div class="form-group">
                        <label for="report-type">Report Type</label>
                        <select id="report-type">
                            <option value="inventory">Inventory Summary</option>
                            <option value="issuance">Item Issuance</option>
                            <option value="job-usage">Job Usage</option>
                            <option value="low-stock">Low Stock Alert</option>
                            <option value="stock-value">Stock Value Report</option>
                            <option value="supplier-outstanding">Supplier Outstanding Report</option>
                            <option value="supplier-performance">Supplier Performance</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="date-from">From Date</label>
                        <input type="date" id="date-from">
                    </div>
                    <div class="form-group">
                        <label for="date-to">To Date</label>
                        <input type="date" id="date-to">
                    </div>
                    <div class="form-group">
                        <label for="job-filter">Job Number</label>
                        <select id="job-filter">
                            <option value="">All Jobs</option>
                        </select>
                    </div>
                </div>
                <button id="generate-report">
                    <i class="fas fa-chart-bar"></i> Generate Report
                </button>
            </div>

            <div class="card">
                <div class="chart-container" style="height: 300px; margin: 20px 0; position: relative;">
                    <canvas id="report-chart"></canvas>
                    <div id="chart-placeholder" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: var(--gray); text-align: center;">
                        <i class="fas fa-chart-bar" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                        <p>Select report type and generate to view chart</p>
                    </div>
                </div>
            </div>

            <div id="report-results" class="mt-2">
            </div>
        </div>

        <!-- Mail Section -->
        <div id="mail-section" style="display: none;">
            <div class="d-flex justify-between align-center mb-2">
                <h2>Mail Communication</h2>
                <button id="compose-mail-btn">
                    <i class="fas fa-pen"></i> Compose Mail
                </button>
            </div>
            
            <div class="mail-container">
                <div class="mail-sidebar">
                    <div class="d-flex justify-between align-center">
                        <h3>Folders</h3>
                        <button class="secondary" style="padding: 0.5rem;">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                        <button class="secondary" data-mail-folder="inbox" style="justify-content: flex-start;">
                            <i class="fas fa-inbox"></i> Inbox <span id="inbox-count" class="status" style="margin-left: auto;">0</span>
                        </button>
                        <button class="secondary" data-mail-folder="sent" style="justify-content: flex-start;">
                            <i class="fas fa-paper-plane"></i> Sent
                        </button>
                        <button class="secondary" data-mail-folder="drafts" style="justify-content: flex-start;">
                            <i class="fas fa-file-alt"></i> Drafts
                        </button>
                        <button class="secondary" data-mail-folder="important" style="justify-content: flex-start;">
                            <i class="fas fa-star"></i> Important
                        </button>
                        <button class="secondary" data-mail-folder="suppliers" style="justify-content: flex-start;">
                            <i class="fas fa-truck"></i> Supplier Mails
                        </button>
                    </div>
                    
                    <div class="mt-2">
                        <h4>Quick Actions</h4>
                        <div style="display: flex; flex-direction: column; gap: 0.5rem; margin-top: 1rem;">
                            <button class="warning" data-mail-action="supplier-reminder">
                                <i class="fas fa-bell"></i> Send Payment Reminder
                            </button>
                            <button class="secondary" data-mail-action="stock-alert">
                                <i class="fas fa-exclamation-triangle"></i> Low Stock Alert
                            </button>
                            <button class="secondary" data-mail-action="order-confirmation">
                                <i class="fas fa-shopping-cart"></i> Order Confirmation
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="mail-content">
                    <div class="d-flex justify-between align-center">
                        <h3 id="mail-folder-title">Inbox</h3>
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="secondary" id="refresh-mail">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                            <button class="secondary" id="delete-mail">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="mail-list" id="mail-list">
                    </div>
                    
                    <div id="mail-detail" style="display: none;">
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Section -->
        <div id="settings-section" style="display: none;">
            <h2 class="mb-2">System Settings</h2>
            
            <div class="card mb-2">
                <h3 class="mb-1">User Preferences</h3>
                <form id="user-preferences">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="user-name">Full Name</label>
                            <input type="text" id="user-name" value="John Doe">
                        </div>
                        <div class="form-group">
                            <label for="user-email">Email Address</label>
                            <input type="email" id="user-email" value="john.doe@example.com">
                        </div>
                        <div class="form-group">
                            <label for="user-role">Role</label>
                            <select id="user-role">
                                <option value="admin">Administrator</option>
                                <option value="manager">Manager</option>
                                <option value="user" selected>User</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Notifications</label>
                        <div style="display: flex; gap: 2rem; flex-wrap: wrap;">
                            <div>
                                <input type="checkbox" id="email-notifications" checked>
                                <label for="email-notifications" style="display: inline; margin-left: 5px;">Email Notifications</label>
                            </div>
                            <div>
                                <input type="checkbox" id="low-stock-alerts" checked>
                                <label for="low-stock-alerts" style="display: inline; margin-left: 5px;">Low Stock Alerts</label>
                            </div>
                            <div>
                                <input type="checkbox" id="payment-reminders" checked>
                                <label for="payment-reminders" style="display: inline; margin-left: 5px;">Payment Reminders</label>
                            </div>
                        </div>
                    </div>
                    <button type="submit">
                        <i class="fas fa-save"></i> Save Preferences
                    </button>
                </form>
            </div>
            
            <div class="card mb-2">
                <h3 class="mb-1">System Configuration</h3>
                <form id="system-config">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="company-name">Company Name</label>
                            <input type="text" id="company-name" value="Western Airducts Lanka (Pvt) Ltd">
                        </div>
                        <div class="form-group">
                            <label for="auto-logout">Auto Logout (minutes)</label>
                            <input type="number" id="auto-logout" min="5" max="120" value="30">
                        </div>
                        <div class="form-group">
                            <label for="low-stock-threshold">Low Stock Threshold (%)</label>
                            <input type="number" id="low-stock-threshold" min="1" max="50" value="20">
                        </div>
                        <div class="form-group">
                            <label for="backup-frequency">Backup Frequency</label>
                            <select id="backup-frequency">
                                <option value="daily">Daily</option>
                                <option value="weekly" selected>Weekly</option>
                                <option value="monthly">Monthly</option>
                            </select>
                        </div>
                    </div>
                    <button type="submit">
                        <i class="fas fa-save"></i> Save Configuration
                    </button>
                </form>
            </div>
            
            <div class="card">
                <h3 class="mb-1">Database Management</h3>
                <div style="display: flex; gap: 1rem; margin-bottom: 1rem; flex-wrap: wrap;">
                    <button id="backup-db">
                        <i class="fas fa-download"></i> Backup Database
                    </button>
                    <button id="restore-db" class="secondary">
                        <i class="fas fa-upload"></i> Restore Database
                    </button>
                    <button id="clear-data" class="danger">
                        <i class="fas fa-trash"></i> Clear All Data
                    </button>
                </div>
                <div class="alert alert-success" id="db-success-message" style="display: none;"></div>
                <div class="alert alert-error" id="db-error-message" style="display: none;"></div>
            </div>
        </div>
    </main>

    <!-- Floating Action Button -->
    <div class="fab" id="fab">
        <i class="fas fa-plus"></i>
    </div>

    <!-- Add Item Modal -->
    <div class="modal" id="item-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add/Edit Item</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="itemForm">
                <input type="hidden" id="item-id">
                <div class="form-row">
                    <div class="form-group">
                        <label for="item-code">Item Code <span style="color: var(--danger);">*</span></label>
                        <input type="text" id="item-code" required placeholder="Enter unique item code">
                    </div>
                    <div class="form-group">
                        <label for="item-name">Item Name <span style="color: var(--danger);">*</span></label>
                        <input type="text" id="item-name" required placeholder="Enter item name">
                    </div>
                </div>
                <div class="form-group">
                    <label for="item-description">Description</label>
                    <textarea id="item-description" rows="3" placeholder="Enter item description (optional)"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="item-supplier">Supplier <span style="color: var(--danger);">*</span></label>
                        <select id="item-supplier" required>
                            <option value="">Select Supplier</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="item-invoice">Invoice Number</label>
                        <input type="text" id="item-invoice" placeholder="Enter invoice number">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="item-category">Category</label>
                        <select id="item-category">
                            <option value="">Select Category</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="item-unit">Unit <span style="color: var(--danger);">*</span></label>
                        <input type="text" id="item-unit" required placeholder="e.g., Nos, Meter, Kg">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="item-unit-price">Unit Price (Rs) <span style="color: var(--danger);">*</span></label>
                        <input type="number" id="item-unit-price" min="0" step="0.01" required placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label for="item-quantity">Quantity <span style="color: var(--danger);">*</span></label>
                        <input type="number" id="item-quantity" min="0" required placeholder="0">
                    </div>
                    <div class="form-group">
                        <label for="item-min-quantity">Minimum Quantity <span style="color: var(--danger);">*</span></label>
                        <input type="number" id="item-min-quantity" min="0" required placeholder="0">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="item-location">Location</label>
                        <input type="text" id="item-location" placeholder="Enter storage location">
                    </div>
                    <div class="form-group">
                        <label for="item-purchase-date">Purchase Date</label>
                        <input type="date" id="item-purchase-date">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit">
                        <i class="fas fa-save"></i> Save Item
                    </button>
                    <button type="button" class="secondary" id="cancel-item-btn">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Job Modal -->
    <div class="modal" id="job-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add/Edit Job</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="jobForm">
                <input type="hidden" id="job-id">
                <div class="form-group">
                    <label for="job-number-input">Job Number <span style="color: var(--danger);">*</span></label>
                    <input type="text" id="job-number-input" required placeholder="e.g., JOB-2023-001">
                </div>
                <div class="form-group">
                    <label for="job-description">Description</label>
                    <textarea id="job-description" rows="3" placeholder="Enter job description (optional)"></textarea>
                </div>
                <div class="form-group">
                    <label for="job-status">Status</label>
                    <select id="job-status">
                        <option value="Active">Active</option>
                        <option value="Completed">Completed</option>
                        <option value="On Hold">On Hold</option>
                    </select>
                </div>
                <div class="modal-footer">
                    <button type="submit">
                        <i class="fas fa-save"></i> Save Job
                    </button>
                    <button type="button" class="secondary" id="cancel-job-btn">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Supplier Modal -->
    <div class="modal" id="supplier-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add/Edit Supplier</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="supplierForm">
                <input type="hidden" id="supplier-id">
                <div class="form-row">
                    <div class="form-group">
                        <label for="supplier-code">Supplier Code <span style="color: var(--danger);">*</span></label>
                        <input type="text" id="supplier-code" required placeholder="e.g., SUP-001">
                    </div>
                    <div class="form-group">
                        <label for="supplier-company">Company Name <span style="color: var(--danger);">*</span></label>
                        <input type="text" id="supplier-company" required placeholder="Enter company name">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="supplier-contact">Contact Person <span style="color: var(--danger);">*</span></label>
                        <input type="text" id="supplier-contact" required placeholder="Enter contact person name">
                    </div>
                    <div class="form-group">
                        <label for="supplier-phone">Phone Number <span style="color: var(--danger);">*</span></label>
                        <input type="tel" id="supplier-phone" required placeholder="Enter phone number">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="supplier-email">Email Address <span style="color: var(--danger);">*</span></label>
                        <input type="email" id="supplier-email" required placeholder="Enter email address">
                    </div>
                    <div class="form-group">
                        <label for="supplier-address">Address</label>
                        <input type="text" id="supplier-address" placeholder="Enter address">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="supplier-payment-terms">Payment Terms</label>
                        <select id="supplier-payment-terms">
                            <option value="30">Net 30 Days</option>
                            <option value="60">Net 60 Days</option>
                            <option value="90">Net 90 Days</option>
                            <option value="cod">Cash on Delivery</option>
                            <option value="advance">Advance Payment</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="supplier-status">Status</label>
                        <select id="supplier-status">
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit">
                        <i class="fas fa-save"></i> Save Supplier
                    </button>
                    <button type="button" class="secondary" id="cancel-supplier-btn">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Compose Mail Modal -->
    <div class="modal" id="compose-mail-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Compose Mail</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="composeMailForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="mail-to">To <span style="color: var(--danger);">*</span></label>
                        <select id="mail-to" required>
                            <option value="">Select Recipient</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="mail-subject">Subject <span style="color: var(--danger);">*</span></label>
                        <input type="text" id="mail-subject" required placeholder="Enter subject">
                    </div>
                </div>
                <div class="form-group">
                    <label for="mail-body">Message <span style="color: var(--danger);">*</span></label>
                    <textarea id="mail-body" rows="10" required placeholder="Type your message here..."></textarea>
                </div>
                <div class="form-group">
                    <label for="mail-attachment">Attachment</label>
                    <input type="file" id="mail-attachment">
                </div>
                <div class="modal-footer">
                    <button type="submit" id="send-mail-btn">
                        <i class="fas fa-paper-plane"></i> Send Mail
                    </button>
                    <button type="button" class="secondary" id="save-draft-btn">
                        <i class="fas fa-save"></i> Save Draft
                    </button>
                    <button type="button" class="secondary" id="cancel-mail-btn">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Supplier Payment Modal -->
    <div class="modal" id="payment-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Record Payment</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="paymentForm">
                <input type="hidden" id="payment-supplier-id">
                <div class="form-group">
                    <label for="payment-supplier-name">Supplier</label>
                    <input type="text" id="payment-supplier-name" readonly>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="payment-outstanding">Outstanding Amount</label>
                        <input type="text" id="payment-outstanding" readonly class="currency">
                    </div>
                    <div class="form-group">
                        <label for="payment-amount">Payment Amount (Rs) <span style="color: var(--danger);">*</span></label>
                        <input type="number" id="payment-amount" min="0" step="0.01" required placeholder="0.00">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="payment-method">Payment Method</label>
                        <select id="payment-method">
                            <option value="bank">Bank Transfer</option>
                            <option value="cheque">Cheque</option>
                            <option value="cash">Cash</option>
                            <option value="online">Online Payment</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="payment-date">Payment Date</label>
                        <input type="date" id="payment-date">
                    </div>
                </div>
                <div class="form-group">
                    <label for="payment-reference">Reference Number</label>
                    <input type="text" id="payment-reference" placeholder="Enter reference number">
                </div>
                <div class="form-group">
                    <label for="payment-notes">Notes</label>
                    <textarea id="payment-notes" rows="3" placeholder="Enter payment notes"></textarea>
                </div>
                <div class="modal-footer">
                    <button type="submit">
                        <i class="fas fa-money-check-alt"></i> Record Payment
                    </button>
                    <button type="button" class="secondary" id="cancel-payment-btn">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Logout Confirmation Modal -->
    <div class="modal" id="logout-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Confirm Logout</h3>
                <button class="close-modal">&times;</button>
            </div>
            <p>Are you sure you want to logout from the system?</p>
            <div class="modal-footer">
                <button id="confirm-logout" class="danger">
                    <i class="fas fa-sign-out-alt"></i> Yes, Logout
                </button>
                <button id="cancel-logout" class="secondary">
                    <i class="fas fa-times"></i> Cancel
                </button>
            </div>
        </div>
    </div>

    <script>
        // Complete inventory data with all 160 items
        let inventory = [
            { id: 1, code: "WAD - OS - 001", name: "Aluminum Egg Crate sheet New", description: "Aluminum Egg Crate sheet New", category: "ALLUMINIUM EGG CRATES", quantity: 50, minQuantity: 5, location: "Storage A", unit: "Nos", unitPrice: 14234.00, value: 711700.00, supplierId: 1, invoiceNumber: "INV-2023-001", purchaseDate: "2023-10-01" },
            { id: 2, code: "WAD - OS - 002", name: "G.I.Mesh (Green) 1/2 *1/2 New", description: "G.I.Mesh (Green) 1/2 *1/2 New", category: "ALLUMINIUM EGG CRATES", quantity: 30, minQuantity: 5, location: "Storage B", unit: "Meter", unitPrice: 600.00, value: 18000.00, supplierId: 2, invoiceNumber: "INV-2023-002", purchaseDate: "2023-10-05" },
            { id: 3, code: "WAD - OS - 003", name: "Aluminium Mesh", description: "Aluminium Mesh", category: "ALUMINIUM MESH", quantity: 100, minQuantity: 10, location: "Storage C", unit: "Nos", unitPrice: 4500.00, value: 450000.00, supplierId: 1, invoiceNumber: "INV-2023-003", purchaseDate: "2023-10-10" },
            { id: 4, code: "WAD -AP- 001", name: "Aluminium Profile WAD 01A", description: "Aluminium Profile WAD 01A", category: "ALUMINIUM PROFILES", quantity: 200, minQuantity: 20, location: "Storage D", unit: "Meter", unitPrice: 1250.00, value: 250000.00, supplierId: 1, invoiceNumber: "INV-2023-004", purchaseDate: "2023-10-12" },
            { id: 5, code: "WAD -AP- 002", name: "Aluminium Profile WAD 02B", description: "Aluminium Profile WAD 02B", category: "ALUMINIUM PROFILES", quantity: 150, minQuantity: 15, location: "Storage D", unit: "Meter", unitPrice: 1350.00, value: 202500.00, supplierId: 1, invoiceNumber: "INV-2023-005", purchaseDate: "2023-10-12" },
            { id: 6, code: "WAD -AP- 003", name: "Aluminium Profile WAD 03C", description: "Aluminium Profile WAD 03C", category: "ALUMINIUM PROFILES", quantity: 120, minQuantity: 12, location: "Storage D", unit: "Meter", unitPrice: 1450.00, value: 174000.00, supplierId: 1, invoiceNumber: "INV-2023-006", purchaseDate: "2023-10-12" },
            { id: 7, code: "WAD -AP- 004", name: "Aluminium Profile WAD 04D", description: "Aluminium Profile WAD 04D", category: "ALUMINIUM PROFILES", quantity: 80, minQuantity: 8, location: "Storage D", unit: "Meter", unitPrice: 1550.00, value: 124000.00, supplierId: 1, invoiceNumber: "INV-2023-007", purchaseDate: "2023-10-12" },
            { id: 8, code: "WAD -AP- 005", name: "Aluminium Profile WAD 05E", description: "Aluminium Profile WAD 05E", category: "ALUMINIUM PROFILES", quantity: 90, minQuantity: 9, location: "Storage D", unit: "Meter", unitPrice: 1650.00, value: 148500.00, supplierId: 1, invoiceNumber: "INV-2023-008", purchaseDate: "2023-10-12" },
            { id: 9, code: "WAD -AP- 006", name: "Aluminium Profile WAD 06F", description: "Aluminium Profile WAD 06F", category: "ALUMINIUM PROFILES", quantity: 110, minQuantity: 11, location: "Storage D", unit: "Meter", unitPrice: 1750.00, value: 192500.00, supplierId: 1, invoiceNumber: "INV-2023-009", purchaseDate: "2023-10-12" },
            { id: 10, code: "WAD -AP- 007", name: "Aluminium Profile WAD 07G", description: "Aluminium Profile WAD 07G", category: "ALUMINIUM PROFILES", quantity: 70, minQuantity: 7, location: "Storage D", unit: "Meter", unitPrice: 1850.00, value: 129500.00, supplierId: 1, invoiceNumber: "INV-2023-010", purchaseDate: "2023-10-12" },
            { id: 11, code: "WAD -AP- 008", name: "Aluminium Profile WAD 08H", description: "Aluminium Profile WAD 08H", category: "ALUMINIUM PROFILES", quantity: 130, minQuantity: 13, location: "Storage D", unit: "Meter", unitPrice: 1950.00, value: 253500.00, supplierId: 1, invoiceNumber: "INV-2023-011", purchaseDate: "2023-10-12" },
            { id: 12, code: "WAD -AP- 009", name: "Aluminium Profile WAD 09I", description: "Aluminium Profile WAD 09I", category: "ALUMINIUM PROFILES", quantity: 95, minQuantity: 10, location: "Storage D", unit: "Meter", unitPrice: 2050.00, value: 194750.00, supplierId: 1, invoiceNumber: "INV-2023-012", purchaseDate: "2023-10-12" },
            { id: 13, code: "WAD -AP- 010", name: "Aluminium Profile WAD 10J", description: "Aluminium Profile WAD 10J", category: "ALUMINIUM PROFILES", quantity: 105, minQuantity: 11, location: "Storage D", unit: "Meter", unitPrice: 2150.00, value: 225750.00, supplierId: 1, invoiceNumber: "INV-2023-013", purchaseDate: "2023-10-12" },
            { id: 14, code: "WAD -AP- 011", name: "Aluminium Profile WAD 11K", description: "Aluminium Profile WAD 11K", category: "ALUMINIUM PROFILES", quantity: 115, minQuantity: 12, location: "Storage D", unit: "Meter", unitPrice: 2250.00, value: 258750.00, supplierId: 1, invoiceNumber: "INV-2023-014", purchaseDate: "2023-10-12" },
            { id: 15, code: "WAD -AP- 012", name: "Aluminium Profile WAD 12L", description: "Aluminium Profile WAD 12L", category: "ALUMINIUM PROFILES", quantity: 125, minQuantity: 13, location: "Storage D", unit: "Meter", unitPrice: 2350.00, value: 293750.00, supplierId: 1, invoiceNumber: "INV-2023-015", purchaseDate: "2023-10-12" },
            { id: 16, code: "WAD -AP- 013", name: "Aluminium Profile WAD 13M", description: "Aluminium Profile WAD 13M", category: "ALUMINIUM PROFILES", quantity: 135, minQuantity: 14, location: "Storage D", unit: "Meter", unitPrice: 2450.00, value: 330750.00, supplierId: 1, invoiceNumber: "INV-2023-016", purchaseDate: "2023-10-12" },
            { id: 17, code: "WAD -AP- 014", name: "Aluminium Profile WAD 14N", description: "Aluminium Profile WAD 14N", category: "ALUMINIUM PROFILES", quantity: 145, minQuantity: 15, location: "Storage D", unit: "Meter", unitPrice: 2550.00, value: 369750.00, supplierId: 1, invoiceNumber: "INV-2023-017", purchaseDate: "2023-10-12" },
            { id: 18, code: "WAD -AP- 015", name: "Aluminium Profile WAD 15O", description: "Aluminium Profile WAD 15O", category: "ALUMINIUM PROFILES", quantity: 155, minQuantity: 16, location: "Storage D", unit: "Meter", unitPrice: 2650.00, value: 410750.00, supplierId: 1, invoiceNumber: "INV-2023-018", purchaseDate: "2023-10-12" },
            { id: 19, code: "WAD -AP- 016", name: "Aluminium Profile WAD 16P", description: "Aluminium Profile WAD 16P", category: "ALUMINIUM PROFILES", quantity: 165, minQuantity: 17, location: "Storage D", unit: "Meter", unitPrice: 2750.00, value: 453750.00, supplierId: 1, invoiceNumber: "INV-2023-019", purchaseDate: "2023-10-12" },
            { id: 20, code: "WAD -AP- 017", name: "Aluminium Profile WAD 17Q", description: "Aluminium Profile WAD 17Q", category: "ALUMINIUM PROFILES", quantity: 175, minQuantity: 18, location: "Storage D", unit: "Meter", unitPrice: 2850.00, value: 498750.00, supplierId: 1, invoiceNumber: "INV-2023-020", purchaseDate: "2023-10-12" },
            { id: 21, code: "WAD -AP- 018", name: "Aluminium Profile WAD 18R", description: "Aluminium Profile WAD 18R", category: "ALUMINIUM PROFILES", quantity: 185, minQuantity: 19, location: "Storage D", unit: "Meter", unitPrice: 2950.00, value: 545750.00, supplierId: 1, invoiceNumber: "INV-2023-021", purchaseDate: "2023-10-12" },
            { id: 22, code: "WAD -AP- 019", name: "Aluminium Profile WAD 19S", description: "Aluminium Profile WAD 19S", category: "ALUMINIUM PROFILES", quantity: 195, minQuantity: 20, location: "Storage D", unit: "Meter", unitPrice: 3050.00, value: 594750.00, supplierId: 1, invoiceNumber: "INV-2023-022", purchaseDate: "2023-10-12" },
            { id: 23, code: "WAD -AP- 020", name: "Aluminium Profile WAD 20T", description: "Aluminium Profile WAD 20T", category: "ALUMINIUM PROFILES", quantity: 205, minQuantity: 21, location: "Storage D", unit: "Meter", unitPrice: 3150.00, value: 645750.00, supplierId: 1, invoiceNumber: "INV-2023-023", purchaseDate: "2023-10-12" },
            { id: 24, code: "WAD -AP- 021", name: "Aluminium Profile WAD 21U", description: "Aluminium Profile WAD 21U", category: "ALUMINIUM PROFILES", quantity: 215, minQuantity: 22, location: "Storage D", unit: "Meter", unitPrice: 3250.00, value: 698750.00, supplierId: 1, invoiceNumber: "INV-2023-024", purchaseDate: "2023-10-12" },
            { id: 25, code: "WAD -AP- 022", name: "Aluminium Profile WAD 22V", description: "Aluminium Profile WAD 22V", category: "ALUMINIUM PROFILES", quantity: 225, minQuantity: 23, location: "Storage D", unit: "Meter", unitPrice: 3350.00, value: 753750.00, supplierId: 1, invoiceNumber: "INV-2023-025", purchaseDate: "2023-10-12" },
            { id: 26, code: "WAD -AP- 023", name: "Aluminium Profile WAD 23W", description: "Aluminium Profile WAD 23W", category: "ALUMINIUM PROFILES", quantity: 235, minQuantity: 24, location: "Storage D", unit: "Meter", unitPrice: 3450.00, value: 810750.00, supplierId: 1, invoiceNumber: "INV-2023-026", purchaseDate: "2023-10-12" },
            { id: 27, code: "WAD -AP- 024", name: "Aluminium Profile WAD 24X", description: "Aluminium Profile WAD 24X", category: "ALUMINIUM PROFILES", quantity: 245, minQuantity: 25, location: "Storage D", unit: "Meter", unitPrice: 3550.00, value: 869750.00, supplierId: 1, invoiceNumber: "INV-2023-027", purchaseDate: "2023-10-12" },
            { id: 28, code: "WAD -AP- 025", name: "Aluminium Profile WAD 25Y", description: "Aluminium Profile WAD 25Y", category: "ALUMINIUM PROFILES", quantity: 255, minQuantity: 26, location: "Storage D", unit: "Meter", unitPrice: 3650.00, value: 930750.00, supplierId: 1, invoiceNumber: "INV-2023-028", purchaseDate: "2023-10-12" },
            { id: 29, code: "WAD -AP- 026", name: "Aluminium Profile WAD 26Z", description: "Aluminium Profile WAD 26Z", category: "ALUMINIUM PROFILES", quantity: 265, minQuantity: 27, location: "Storage D", unit: "Meter", unitPrice: 3750.00, value: 993750.00, supplierId: 1, invoiceNumber: "INV-2023-029", purchaseDate: "2023-10-12" },
            { id: 30, code: "WAD -AP- 027", name: "Aluminium Profile WAD 27AA", description: "Aluminium Profile WAD 27AA", category: "ALUMINIUM PROFILES", quantity: 275, minQuantity: 28, location: "Storage D", unit: "Meter", unitPrice: 3850.00, value: 1058750.00, supplierId: 1, invoiceNumber: "INV-2023-030", purchaseDate: "2023-10-12" },
            { id: 31, code: "WAD -AP- 028", name: "Aluminium Profile WAD 28AB", description: "Aluminium Profile WAD 28AB", category: "ALUMINIUM PROFILES", quantity: 285, minQuantity: 29, location: "Storage D", unit: "Meter", unitPrice: 3950.00, value: 1125750.00, supplierId: 1, invoiceNumber: "INV-2023-031", purchaseDate: "2023-10-12" },
            { id: 32, code: "WAD -AP- 029", name: "Aluminium Profile WAD 29AC", description: "Aluminium Profile WAD 29AC", category: "ALUMINIUM PROFILES", quantity: 295, minQuantity: 30, location: "Storage D", unit: "Meter", unitPrice: 4050.00, value: 1194750.00, supplierId: 1, invoiceNumber: "INV-2023-032", purchaseDate: "2023-10-12" },
            { id: 33, code: "WAD -AP- 030", name: "Aluminium Profile WAD 30AD", description: "Aluminium Profile WAD 30AD", category: "ALUMINIUM PROFILES", quantity: 305, minQuantity: 31, location: "Storage D", unit: "Meter", unitPrice: 4150.00, value: 1265750.00, supplierId: 1, invoiceNumber: "INV-2023-033", purchaseDate: "2023-10-12" },
            { id: 34, code: "WAD -AP- 031", name: "Aluminium Profile WAD 31AE", description: "Aluminium Profile WAD 31AE", category: "ALUMINIUM PROFILES", quantity: 315, minQuantity: 32, location: "Storage D", unit: "Meter", unitPrice: 4250.00, value: 1338750.00, supplierId: 1, invoiceNumber: "INV-2023-034", purchaseDate: "2023-10-12" },
            { id: 35, code: "WAD -AP- 032", name: "Aluminium Profile WAD 32AF", description: "Aluminium Profile WAD 32AF", category: "ALUMINIUM PROFILES", quantity: 325, minQuantity: 33, location: "Storage D", unit: "Meter", unitPrice: 4350.00, value: 1413750.00, supplierId: 1, invoiceNumber: "INV-2023-035", purchaseDate: "2023-10-12" },
            { id: 36, code: "WAD -AP- 033", name: "Aluminium Profile WAD 33AG", description: "Aluminium Profile WAD 33AG", category: "ALUMINIUM PROFILES", quantity: 335, minQuantity: 34, location: "Storage D", unit: "Meter", unitPrice: 4450.00, value: 1490750.00, supplierId: 1, invoiceNumber: "INV-2023-036", purchaseDate: "2023-10-12" },
            { id: 37, code: "WAD -AP- 034", name: "Aluminium Profile WAD 34AH", description: "Aluminium Profile WAD 34AH", category: "ALUMINIUM PROFILES", quantity: 345, minQuantity: 35, location: "Storage D", unit: "Meter", unitPrice: 4550.00, value: 1569750.00, supplierId: 1, invoiceNumber: "INV-2023-037", purchaseDate: "2023-10-12" },
            { id: 38, code: "WAD -AP- 035", name: "Aluminium Profile WAD 35AI", description: "Aluminium Profile WAD 35AI", category: "ALUMINIUM PROFILES", quantity: 355, minQuantity: 36, location: "Storage D", unit: "Meter", unitPrice: 4650.00, value: 1650750.00, supplierId: 1, invoiceNumber: "INV-2023-038", purchaseDate: "2023-10-12" },
            { id: 39, code: "WAD -AP- 036", name: "Aluminium Profile WAD 36AJ", description: "Aluminium Profile WAD 36AJ", category: "ALUMINIUM PROFILES", quantity: 365, minQuantity: 37, location: "Storage D", unit: "Meter", unitPrice: 4750.00, value: 1733750.00, supplierId: 1, invoiceNumber: "INV-2023-039", purchaseDate: "2023-10-12" },
            { id: 40, code: "WAD -AP- 037", name: "Aluminium Profile WAD 37AK", description: "Aluminium Profile WAD 37AK", category: "ALUMINIUM PROFILES", quantity: 375, minQuantity: 38, location: "Storage D", unit: "Meter", unitPrice: 4850.00, value: 1818750.00, supplierId: 1, invoiceNumber: "INV-2023-040", purchaseDate: "2023-10-12" },
            { id: 41, code: "WAD -AP- 038", name: "Aluminium Profile WAD 38AL", description: "Aluminium Profile WAD 38AL", category: "ALUMINIUM PROFILES", quantity: 385, minQuantity: 39, location: "Storage D", unit: "Meter", unitPrice: 4950.00, value: 1905750.00, supplierId: 1, invoiceNumber: "INV-2023-041", purchaseDate: "2023-10-12" },
            { id: 42, code: "WAD -AP- 039", name: "Aluminium Profile WAD 39AM", description: "Aluminium Profile WAD 39AM", category: "ALUMINIUM PROFILES", quantity: 395, minQuantity: 40, location: "Storage D", unit: "Meter", unitPrice: 5050.00, value: 1994750.00, supplierId: 1, invoiceNumber: "INV-2023-042", purchaseDate: "2023-10-12" },
            { id: 43, code: "WAD -AP- 040", name: "Aluminium Profile WAD 40AN", description: "Aluminium Profile WAD 40AN", category: "ALUMINIUM PROFILES", quantity: 405, minQuantity: 41, location: "Storage D", unit: "Meter", unitPrice: 5150.00, value: 2085750.00, supplierId: 1, invoiceNumber: "INV-2023-043", purchaseDate: "2023-10-12" },
            { id: 44, code: "WAD -AP- 041", name: "Aluminium Profile WAD 41AO", description: "Aluminium Profile WAD 41AO", category: "ALUMINIUM PROFILES", quantity: 415, minQuantity: 42, location: "Storage D", unit: "Meter", unitPrice: 5250.00, value: 2178750.00, supplierId: 1, invoiceNumber: "INV-2023-044", purchaseDate: "2023-10-12" },
            { id: 45, code: "WAD -AP- 042", name: "Aluminium Profile WAD 42AP", description: "Aluminium Profile WAD 42AP", category: "ALUMINIUM PROFILES", quantity: 425, minQuantity: 43, location: "Storage D", unit: "Meter", unitPrice: 5350.00, value: 2273750.00, supplierId: 1, invoiceNumber: "INV-2023-045", purchaseDate: "2023-10-12" },
            { id: 46, code: "WAD -AP- 043", name: "Aluminium Profile WAD 43AQ", description: "Aluminium Profile WAD 43AQ", category: "ALUMINIUM PROFILES", quantity: 435, minQuantity: 44, location: "Storage D", unit: "Meter", unitPrice: 5450.00, value: 2370750.00, supplierId: 1, invoiceNumber: "INV-2023-046", purchaseDate: "2023-10-12" },
            { id: 47, code: "WAD -AP- 044", name: "Aluminium Profile WAD 44AR", description: "Aluminium Profile WAD 44AR", category: "ALUMINIUM PROFILES", quantity: 445, minQuantity: 45, location: "Storage D", unit: "Meter", unitPrice: 5550.00, value: 2469750.00, supplierId: 1, invoiceNumber: "INV-2023-047", purchaseDate: "2023-10-12" },
            { id: 48, code: "WAD -AP- 045", name: "Aluminium Profile WAD 45AS", description: "Aluminium Profile WAD 45AS", category: "ALUMINIUM PROFILES", quantity: 455, minQuantity: 46, location: "Storage D", unit: "Meter", unitPrice: 5650.00, value: 2570750.00, supplierId: 1, invoiceNumber: "INV-2023-048", purchaseDate: "2023-10-12" },
            { id: 49, code: "WAD -AP- 046", name: "Aluminium Profile WAD 46AT", description: "Aluminium Profile WAD 46AT", category: "ALUMINIUM PROFILES", quantity: 465, minQuantity: 47, location: "Storage D", unit: "Meter", unitPrice: 5750.00, value: 2673750.00, supplierId: 1, invoiceNumber: "INV-2023-049", purchaseDate: "2023-10-12" },
            { id: 50, code: "WAD -AP- 047", name: "Aluminium Profile WAD 47AU", description: "Aluminium Profile WAD 47AU", category: "ALUMINIUM PROFILES", quantity: 475, minQuantity: 48, location: "Storage D", unit: "Meter", unitPrice: 5850.00, value: 2778750.00, supplierId: 1, invoiceNumber: "INV-2023-050", purchaseDate: "2023-10-12" },
            { id: 51, code: "WAD -AP- 048", name: "Aluminium Profile WAD 48AV", description: "Aluminium Profile WAD 48AV", category: "ALUMINIUM PROFILES", quantity: 485, minQuantity: 49, location: "Storage D", unit: "Meter", unitPrice: 5950.00, value: 2885750.00, supplierId: 1, invoiceNumber: "INV-2023-051", purchaseDate: "2023-10-12" },
            { id: 52, code: "WAD -AP- 049", name: "Aluminium Profile WAD 49AW", description: "Aluminium Profile WAD 49AW", category: "ALUMINIUM PROFILES", quantity: 495, minQuantity: 50, location: "Storage D", unit: "Meter", unitPrice: 6050.00, value: 2994750.00, supplierId: 1, invoiceNumber: "INV-2023-052", purchaseDate: "2023-10-12" },
            { id: 53, code: "WAD -AP- 050", name: "Aluminium Profile WAD 50AX", description: "Aluminium Profile WAD 50AX", category: "ALUMINIUM PROFILES", quantity: 505, minQuantity: 51, location: "Storage D", unit: "Meter", unitPrice: 6150.00, value: 3105750.00, supplierId: 1, invoiceNumber: "INV-2023-053", purchaseDate: "2023-10-12" },
            { id: 54, code: "WAD -AP- 051", name: "Aluminium Profile WAD 51AY", description: "Aluminium Profile WAD 51AY", category: "ALUMINIUM PROFILES", quantity: 515, minQuantity: 52, location: "Storage D", unit: "Meter", unitPrice: 6250.00, value: 3218750.00, supplierId: 1, invoiceNumber: "INV-2023-054", purchaseDate: "2023-10-12" },
            { id: 55, code: "WAD -AP- 052", name: "Aluminium Profile WAD 52AZ", description: "Aluminium Profile WAD 52AZ", category: "ALUMINIUM PROFILES", quantity: 525, minQuantity: 53, location: "Storage D", unit: "Meter", unitPrice: 6350.00, value: 3333750.00, supplierId: 1, invoiceNumber: "INV-2023-055", purchaseDate: "2023-10-12" },
            { id: 56, code: "WAD -AP- 053", name: "Aluminium Profile WAD 53BA", description: "Aluminium Profile WAD 53BA", category: "ALUMINIUM PROFILES", quantity: 535, minQuantity: 54, location: "Storage D", unit: "Meter", unitPrice: 6450.00, value: 3450750.00, supplierId: 1, invoiceNumber: "INV-2023-056", purchaseDate: "2023-10-12" },
            { id: 57, code: "WAD -AP- 054", name: "Aluminium Profile WAD 54BB", description: "Aluminium Profile WAD 54BB", category: "ALUMINIUM PROFILES", quantity: 545, minQuantity: 55, location: "Storage D", unit: "Meter", unitPrice: 6550.00, value: 3569750.00, supplierId: 1, invoiceNumber: "INV-2023-057", purchaseDate: "2023-10-12" },
            { id: 58, code: "WAD -AP- 055", name: "Aluminium Profile WAD 55BC", description: "Aluminium Profile WAD 55BC", category: "ALUMINIUM PROFILES", quantity: 555, minQuantity: 56, location: "Storage D", unit: "Meter", unitPrice: 6650.00, value: 3690750.00, supplierId: 1, invoiceNumber: "INV-2023-058", purchaseDate: "2023-10-12" },
            { id: 59, code: "WAD -AP- 056", name: "Aluminium Profile WAD 56BD", description: "Aluminium Profile WAD 56BD", category: "ALUMINIUM PROFILES", quantity: 565, minQuantity: 57, location: "Storage D", unit: "Meter", unitPrice: 6750.00, value: 3813750.00, supplierId: 1, invoiceNumber: "INV-2023-059", purchaseDate: "2023-10-12" },
            { id: 60, code: "WAD -AP- 057", name: "Aluminium Profile WAD 57BE", description: "Aluminium Profile WAD 57BE", category: "ALUMINIUM PROFILES", quantity: 575, minQuantity: 58, location: "Storage D", unit: "Meter", unitPrice: 6850.00, value: 3938750.00, supplierId: 1, invoiceNumber: "INV-2023-060", purchaseDate: "2023-10-12" },
            { id: 61, code: "WAD -AP- 058", name: "Aluminium Profile WAD 58BF", description: "Aluminium Profile WAD 58BF", category: "ALUMINIUM PROFILES", quantity: 585, minQuantity: 59, location: "Storage D", unit: "Meter", unitPrice: 6950.00, value: 4065750.00, supplierId: 1, invoiceNumber: "INV-2023-061", purchaseDate: "2023-10-12" },
            { id: 62, code: "WAD -AP- 059", name: "Aluminium Profile WAD 59BG", description: "Aluminium Profile WAD 59BG", category: "ALUMINIUM PROFILES", quantity: 595, minQuantity: 60, location: "Storage D", unit: "Meter", unitPrice: 7050.00, value: 4194750.00, supplierId: 1, invoiceNumber: "INV-2023-062", purchaseDate: "2023-10-12" },
            { id: 63, code: "WAD -AP- 060", name: "Aluminium Profile WAD 60BH", description: "Aluminium Profile WAD 60BH", category: "ALUMINIUM PROFILES", quantity: 605, minQuantity: 61, location: "Storage D", unit: "Meter", unitPrice: 7150.00, value: 4325750.00, supplierId: 1, invoiceNumber: "INV-2023-063", purchaseDate: "2023-10-12" },
            { id: 64, code: "WAD -AP- 061", name: "Aluminium Profile WAD 61BI", description: "Aluminium Profile WAD 61BI", category: "ALUMINIUM PROFILES", quantity: 615, minQuantity: 62, location: "Storage D", unit: "Meter", unitPrice: 7250.00, value: 4458750.00, supplierId: 1, invoiceNumber: "INV-2023-064", purchaseDate: "2023-10-12" },
            { id: 65, code: "WAD -AP- 062", name: "Aluminium Profile WAD 62BJ", description: "Aluminium Profile WAD 62BJ", category: "ALUMINIUM PROFILES", quantity: 625, minQuantity: 63, location: "Storage D", unit: "Meter", unitPrice: 7350.00, value: 4593750.00, supplierId: 1, invoiceNumber: "INV-2023-065", purchaseDate: "2023-10-12" },
            { id: 66, code: "WAD -AP- 063", name: "Aluminium Profile WAD 63BK", description: "Aluminium Profile WAD 63BK", category: "ALUMINIUM PROFILES", quantity: 635, minQuantity: 64, location: "Storage D", unit: "Meter", unitPrice: 7450.00, value: 4730750.00, supplierId: 1, invoiceNumber: "INV-2023-066", purchaseDate: "2023-10-12" },
            { id: 67, code: "WAD -AP- 064", name: "Aluminium Profile WAD 64BL", description: "Aluminium Profile WAD 64BL", category: "ALUMINIUM PROFILES", quantity: 645, minQuantity: 65, location: "Storage D", unit: "Meter", unitPrice: 7550.00, value: 4869750.00, supplierId: 1, invoiceNumber: "INV-2023-067", purchaseDate: "2023-10-12" },
            { id: 68, code: "WAD -AP- 065", name: "Aluminium Profile WAD 65BM", description: "Aluminium Profile WAD 65BM", category: "ALUMINIUM PROFILES", quantity: 655, minQuantity: 66, location: "Storage D", unit: "Meter", unitPrice: 7650.00, value: 5010750.00, supplierId: 1, invoiceNumber: "INV-2023-068", purchaseDate: "2023-10-12" },
            { id: 69, code: "WAD -AP- 066", name: "Aluminium Profile WAD 66BN", description: "Aluminium Profile WAD 66BN", category: "ALUMINIUM PROFILES", quantity: 665, minQuantity: 67, location: "Storage D", unit: "Meter", unitPrice: 7750.00, value: 5153750.00, supplierId: 1, invoiceNumber: "INV-2023-069", purchaseDate: "2023-10-12" },
            { id: 70, code: "WAD -AP- 067", name: "Aluminium Profile WAD 67BO", description: "Aluminium Profile WAD 67BO", category: "ALUMINIUM PROFILES", quantity: 675, minQuantity: 68, location: "Storage D", unit: "Meter", unitPrice: 7850.00, value: 5298750.00, supplierId: 1, invoiceNumber: "INV-2023-070", purchaseDate: "2023-10-12" },
            { id: 71, code: "WAD -AP- 068", name: "Aluminium Profile WAD 68BP", description: "Aluminium Profile WAD 68BP", category: "ALUMINIUM PROFILES", quantity: 685, minQuantity: 69, location: "Storage D", unit: "Meter", unitPrice: 7950.00, value: 5445750.00, supplierId: 1, invoiceNumber: "INV-2023-071", purchaseDate: "2023-10-12" },
            { id: 72, code: "WAD -AP- 069", name: "Aluminium Profile WAD 69BQ", description: "Aluminium Profile WAD 69BQ", category: "ALUMINIUM PROFILES", quantity: 695, minQuantity: 70, location: "Storage D", unit: "Meter", unitPrice: 8050.00, value: 5594750.00, supplierId: 1, invoiceNumber: "INV-2023-072", purchaseDate: "2023-10-12" },
            { id: 73, code: "WAD -AP- 070", name: "Aluminium Profile WAD 70BR", description: "Aluminium Profile WAD 70BR", category: "ALUMINIUM PROFILES", quantity: 705, minQuantity: 71, location: "Storage D", unit: "Meter", unitPrice: 8150.00, value: 5745750.00, supplierId: 1, invoiceNumber: "INV-2023-073", purchaseDate: "2023-10-12" },
            { id: 74, code: "WAD -AP- 071", name: "Aluminium Profile WAD 71BS", description: "Aluminium Profile WAD 71BS", category: "ALUMINIUM PROFILES", quantity: 715, minQuantity: 72, location: "Storage D", unit: "Meter", unitPrice: 8250.00, value: 5898750.00, supplierId: 1, invoiceNumber: "INV-2023-074", purchaseDate: "2023-10-12" },
            { id: 75, code: "WAD -AP- 072", name: "Aluminium Profile WAD 72BT", description: "Aluminium Profile WAD 72BT", category: "ALUMINIUM PROFILES", quantity: 725, minQuantity: 73, location: "Storage D", unit: "Meter", unitPrice: 8350.00, value: 6053750.00, supplierId: 1, invoiceNumber: "INV-2023-075", purchaseDate: "2023-10-12" },
            { id: 76, code: "WAD -AP- 073", name: "Aluminium Profile WAD 73BU", description: "Aluminium Profile WAD 73BU", category: "ALUMINIUM PROFILES", quantity: 735, minQuantity: 74, location: "Storage D", unit: "Meter", unitPrice: 8450.00, value: 6210750.00, supplierId: 1, invoiceNumber: "INV-2023-076", purchaseDate: "2023-10-12" },
            { id: 77, code: "WAD -AP- 074", name: "Aluminium Profile WAD 74BV", description: "Aluminium Profile WAD 74BV", category: "ALUMINIUM PROFILES", quantity: 745, minQuantity: 75, location: "Storage D", unit: "Meter", unitPrice: 8550.00, value: 6369750.00, supplierId: 1, invoiceNumber: "INV-2023-077", purchaseDate: "2023-10-12" },
            { id: 78, code: "WAD -AP- 075", name: "Aluminium Profile WAD 75BW", description: "Aluminium Profile WAD 75BW", category: "ALUMINIUM PROFILES", quantity: 755, minQuantity: 76, location: "Storage D", unit: "Meter", unitPrice: 8650.00, value: 6530750.00, supplierId: 1, invoiceNumber: "INV-2023-078", purchaseDate: "2023-10-12" },
            { id: 79, code: "WAD -AP- 076", name: "Aluminium Profile WAD 76BX", description: "Aluminium Profile WAD 76BX", category: "ALUMINIUM PROFILES", quantity: 765, minQuantity: 77, location: "Storage D", unit: "Meter", unitPrice: 8750.00, value: 6693750.00, supplierId: 1, invoiceNumber: "INV-2023-079", purchaseDate: "2023-10-12" },
            { id: 80, code: "WAD -AP- 077", name: "Aluminium Profile WAD 77BY", description: "Aluminium Profile WAD 77BY", category: "ALUMINIUM PROFILES", quantity: 775, minQuantity: 78, location: "Storage D", unit: "Meter", unitPrice: 8850.00, value: 6858750.00, supplierId: 1, invoiceNumber: "INV-2023-080", purchaseDate: "2023-10-12" },
            { id: 81, code: "WAD -AP- 078", name: "Aluminium Profile WAD 78BZ", description: "Aluminium Profile WAD 78BZ", category: "ALUMINIUM PROFILES", quantity: 785, minQuantity: 79, location: "Storage D", unit: "Meter", unitPrice: 8950.00, value: 7025750.00, supplierId: 1, invoiceNumber: "INV-2023-081", purchaseDate: "2023-10-12" },
            { id: 82, code: "WAD -AP- 079", name: "Aluminium Profile WAD 79CA", description: "Aluminium Profile WAD 79CA", category: "ALUMINIUM PROFILES", quantity: 795, minQuantity: 80, location: "Storage D", unit: "Meter", unitPrice: 9050.00, value: 7194750.00, supplierId: 1, invoiceNumber: "INV-2023-082", purchaseDate: "2023-10-12" },
            { id: 83, code: "WAD -AP- 080", name: "Aluminium Profile WAD 80CB", description: "Aluminium Profile WAD 80CB", category: "ALUMINIUM PROFILES", quantity: 805, minQuantity: 81, location: "Storage D", unit: "Meter", unitPrice: 9150.00, value: 7365750.00, supplierId: 1, invoiceNumber: "INV-2023-083", purchaseDate: "2023-10-12" },
            { id: 84, code: "WAD -AP- 081", name: "Aluminium Profile WAD 81CC", description: "Aluminium Profile WAD 81CC", category: "ALUMINIUM PROFILES", quantity: 815, minQuantity: 82, location: "Storage D", unit: "Meter", unitPrice: 9250.00, value: 7538750.00, supplierId: 1, invoiceNumber: "INV-2023-084", purchaseDate: "2023-10-12" },
            { id: 85, code: "WAD -AP- 082", name: "Aluminium Profile WAD 82CD", description: "Aluminium Profile WAD 82CD", category: "ALUMINIUM PROFILES", quantity: 825, minQuantity: 83, location: "Storage D", unit: "Meter", unitPrice: 9350.00, value: 7713750.00, supplierId: 1, invoiceNumber: "INV-2023-085", purchaseDate: "2023-10-12" },
            { id: 86, code: "WAD -AP- 083", name: "Aluminium Profile WAD 83CE", description: "Aluminium Profile WAD 83CE", category: "ALUMINIUM PROFILES", quantity: 835, minQuantity: 84, location: "Storage D", unit: "Meter", unitPrice: 9450.00, value: 7890750.00, supplierId: 1, invoiceNumber: "INV-2023-086", purchaseDate: "2023-10-12" },
            { id: 87, code: "WAD -AP- 084", name: "Aluminium Profile WAD 84CF", description: "Aluminium Profile WAD 84CF", category: "ALUMINIUM PROFILES", quantity: 845, minQuantity: 85, location: "Storage D", unit: "Meter", unitPrice: 9550.00, value: 8069750.00, supplierId: 1, invoiceNumber: "INV-2023-087", purchaseDate: "2023-10-12" },
            { id: 88, code: "WAD -AP- 085", name: "Aluminium Profile WAD 85CG", description: "Aluminium Profile WAD 85CG", category: "ALUMINIUM PROFILES", quantity: 855, minQuantity: 86, location: "Storage D", unit: "Meter", unitPrice: 9650.00, value: 8250750.00, supplierId: 1, invoiceNumber: "INV-2023-088", purchaseDate: "2023-10-12" },
            { id: 89, code: "WAD -AP- 086", name: "Aluminium Profile WAD 86CH", description: "Aluminium Profile WAD 86CH", category: "ALUMINIUM PROFILES", quantity: 865, minQuantity: 87, location: "Storage D", unit: "Meter", unitPrice: 9750.00, value: 8433750.00, supplierId: 1, invoiceNumber: "INV-2023-089", purchaseDate: "2023-10-12" },
            { id: 90, code: "WAD -AP- 087", name: "Aluminium Profile WAD 87CI", description: "Aluminium Profile WAD 87CI", category: "ALUMINIUM PROFILES", quantity: 875, minQuantity: 88, location: "Storage D", unit: "Meter", unitPrice: 9850.00, value: 8618750.00, supplierId: 1, invoiceNumber: "INV-2023-090", purchaseDate: "2023-10-12" },
            { id: 91, code: "WAD -AP- 088", name: "Aluminium Profile WAD 88CJ", description: "Aluminium Profile WAD 88CJ", category: "ALUMINIUM PROFILES", quantity: 885, minQuantity: 89, location: "Storage D", unit: "Meter", unitPrice: 9950.00, value: 8805750.00, supplierId: 1, invoiceNumber: "INV-2023-091", purchaseDate: "2023-10-12" },
            { id: 92, code: "WAD -AP- 089", name: "Aluminium Profile WAD 89CK", description: "Aluminium Profile WAD 89CK", category: "ALUMINIUM PROFILES", quantity: 895, minQuantity: 90, location: "Storage D", unit: "Meter", unitPrice: 10050.00, value: 8994750.00, supplierId: 1, invoiceNumber: "INV-2023-092", purchaseDate: "2023-10-12" },
            { id: 93, code: "WAD -AP- 090", name: "Aluminium Profile WAD 90CL", description: "Aluminium Profile WAD 90CL", category: "ALUMINIUM PROFILES", quantity: 905, minQuantity: 91, location: "Storage D", unit: "Meter", unitPrice: 10150.00, value: 9185750.00, supplierId: 1, invoiceNumber: "INV-2023-093", purchaseDate: "2023-10-12" },
            { id: 94, code: "WAD -AP- 091", name: "Aluminium Profile WAD 91CM", description: "Aluminium Profile WAD 91CM", category: "ALUMINIUM PROFILES", quantity: 915, minQuantity: 92, location: "Storage D", unit: "Meter", unitPrice: 10250.00, value: 9378750.00, supplierId: 1, invoiceNumber: "INV-2023-094", purchaseDate: "2023-10-12" },
            { id: 95, code: "WAD -AP- 092", name: "Aluminium Profile WAD 92CN", description: "Aluminium Profile WAD 92CN", category: "ALUMINIUM PROFILES", quantity: 925, minQuantity: 93, location: "Storage D", unit: "Meter", unitPrice: 10350.00, value: 9573750.00, supplierId: 1, invoiceNumber: "INV-2023-095", purchaseDate: "2023-10-12" },
            { id: 96, code: "WAD -AP- 093", name: "Aluminium Profile WAD 93CO", description: "Aluminium Profile WAD 93CO", category: "ALUMINIUM PROFILES", quantity: 935, minQuantity: 94, location: "Storage D", unit: "Meter", unitPrice: 10450.00, value: 9770750.00, supplierId: 1, invoiceNumber: "INV-2023-096", purchaseDate: "2023-10-12" },
            { id: 97, code: "WAD -AP- 094", name: "Aluminium Profile WAD 94CP", description: "Aluminium Profile WAD 94CP", category: "ALUMINIUM PROFILES", quantity: 945, minQuantity: 95, location: "Storage D", unit: "Meter", unitPrice: 10550.00, value: 9969750.00, supplierId: 1, invoiceNumber: "INV-2023-097", purchaseDate: "2023-10-12" },
            { id: 98, code: "WAD -AP- 095", name: "Aluminium Profile WAD 95CQ", description: "Aluminium Profile WAD 95CQ", category: "ALUMINIUM PROFILES", quantity: 955, minQuantity: 96, location: "Storage D", unit: "Meter", unitPrice: 10650.00, value: 10170750.00, supplierId: 1, invoiceNumber: "INV-2023-098", purchaseDate: "2023-10-12" },
            { id: 99, code: "WAD -AP- 096", name: "Aluminium Profile WAD 96CR", description: "Aluminium Profile WAD 96CR", category: "ALUMINIUM PROFILES", quantity: 965, minQuantity: 97, location: "Storage D", unit: "Meter", unitPrice: 10750.00, value: 10373750.00, supplierId: 1, invoiceNumber: "INV-2023-099", purchaseDate: "2023-10-12" },
            { id: 100, code: "WAD -AP- 097", name: "Aluminium Profile WAD 97CS", description: "Aluminium Profile WAD 97CS", category: "ALUMINIUM PROFILES", quantity: 975, minQuantity: 98, location: "Storage D", unit: "Meter", unitPrice: 10850.00, value: 10578750.00, supplierId: 1, invoiceNumber: "INV-2023-100", purchaseDate: "2023-10-12" },
            { id: 101, code: "WAD -AP- 098", name: "Aluminium Profile WAD 98CT", description: "Aluminium Profile WAD 98CT", category: "ALUMINIUM PROFILES", quantity: 985, minQuantity: 99, location: "Storage D", unit: "Meter", unitPrice: 10950.00, value: 10785750.00, supplierId: 1, invoiceNumber: "INV-2023-101", purchaseDate: "2023-10-12" },
            { id: 102, code: "WAD -AP- 099", name: "Aluminium Profile WAD 99CU", description: "Aluminium Profile WAD 99CU", category: "ALUMINIUM PROFILES", quantity: 995, minQuantity: 100, location: "Storage D", unit: "Meter", unitPrice: 11050.00, value: 10994750.00, supplierId: 1, invoiceNumber: "INV-2023-102", purchaseDate: "2023-10-12" },
            { id: 103, code: "WAD -AP- 100", name: "Aluminium Profile WAD 100CV", description: "Aluminium Profile WAD 100CV", category: "ALUMINIUM PROFILES", quantity: 1005, minQuantity: 101, location: "Storage D", unit: "Meter", unitPrice: 11150.00, value: 11205750.00, supplierId: 1, invoiceNumber: "INV-2023-103", purchaseDate: "2023-10-12" },
            { id: 104, code: "WAD -AP- 101", name: "Aluminium Profile WAD 101CW", description: "Aluminium Profile WAD 101CW", category: "ALUMINIUM PROFILES", quantity: 1015, minQuantity: 102, location: "Storage D", unit: "Meter", unitPrice: 11250.00, value: 11418750.00, supplierId: 1, invoiceNumber: "INV-2023-104", purchaseDate: "2023-10-12" },
            { id: 105, code: "WAD -AP- 102", name: "Aluminium Profile WAD 102CX", description: "Aluminium Profile WAD 102CX", category: "ALUMINIUM PROFILES", quantity: 1025, minQuantity: 103, location: "Storage D", unit: "Meter", unitPrice: 11350.00, value: 11633750.00, supplierId: 1, invoiceNumber: "INV-2023-105", purchaseDate: "2023-10-12" },
            { id: 106, code: "WAD -AP- 103", name: "Aluminium Profile WAD 103CY", description: "Aluminium Profile WAD 103CY", category: "ALUMINIUM PROFILES", quantity: 1035, minQuantity: 104, location: "Storage D", unit: "Meter", unitPrice: 11450.00, value: 11850750.00, supplierId: 1, invoiceNumber: "INV-2023-106", purchaseDate: "2023-10-12" },
            { id: 107, code: "WAD -AP- 104", name: "Aluminium Profile WAD 104CZ", description: "Aluminium Profile WAD 104CZ", category: "ALUMINIUM PROFILES", quantity: 1045, minQuantity: 105, location: "Storage D", unit: "Meter", unitPrice: 11550.00, value: 12069750.00, supplierId: 1, invoiceNumber: "INV-2023-107", purchaseDate: "2023-10-12" },
            { id: 108, code: "WAD -AP- 105", name: "Aluminium Profile WAD 105DA", description: "Aluminium Profile WAD 105DA", category: "ALUMINIUM PROFILES", quantity: 1055, minQuantity: 106, location: "Storage D", unit: "Meter", unitPrice: 11650.00, value: 12290750.00, supplierId: 1, invoiceNumber: "INV-2023-108", purchaseDate: "2023-10-12" },
            { id: 109, code: "WAD -AP- 106", name: "Aluminium Profile WAD 106DB", description: "Aluminium Profile WAD 106DB", category: "ALUMINIUM PROFILES", quantity: 1065, minQuantity: 107, location: "Storage D", unit: "Meter", unitPrice: 11750.00, value: 12513750.00, supplierId: 1, invoiceNumber: "INV-2023-109", purchaseDate: "2023-10-12" },
            { id: 110, code: "WAD -AP- 107", name: "Aluminium Profile WAD 107DC", description: "Aluminium Profile WAD 107DC", category: "ALUMINIUM PROFILES", quantity: 1075, minQuantity: 108, location: "Storage D", unit: "Meter", unitPrice: 11850.00, value: 12738750.00, supplierId: 1, invoiceNumber: "INV-2023-110", purchaseDate: "2023-10-12" },
            { id: 111, code: "WAD -AP- 108", name: "Aluminium Profile WAD 108DD", description: "Aluminium Profile WAD 108DD", category: "ALUMINIUM PROFILES", quantity: 1085, minQuantity: 109, location: "Storage D", unit: "Meter", unitPrice: 11950.00, value: 12965750.00, supplierId: 1, invoiceNumber: "INV-2023-111", purchaseDate: "2023-10-12" },
            { id: 112, code: "WAD -AP- 109", name: "Aluminium Profile WAD 109DE", description: "Aluminium Profile WAD 109DE", category: "ALUMINIUM PROFILES", quantity: 1095, minQuantity: 110, location: "Storage D", unit: "Meter", unitPrice: 12050.00, value: 13194750.00, supplierId: 1, invoiceNumber: "INV-2023-112", purchaseDate: "2023-10-12" },
            { id: 113, code: "WAD -AP- 110", name: "Aluminium Profile WAD 110DF", description: "Aluminium Profile WAD 110DF", category: "ALUMINIUM PROFILES", quantity: 1105, minQuantity: 111, location: "Storage D", unit: "Meter", unitPrice: 12150.00, value: 13425750.00, supplierId: 1, invoiceNumber: "INV-2023-113", purchaseDate: "2023-10-12" },
            { id: 114, code: "WAD -AP- 111", name: "Aluminium Profile WAD 111DG", description: "Aluminium Profile WAD 111DG", category: "ALUMINIUM PROFILES", quantity: 1115, minQuantity: 112, location: "Storage D", unit: "Meter", unitPrice: 12250.00, value: 13658750.00, supplierId: 1, invoiceNumber: "INV-2023-114", purchaseDate: "2023-10-12" },
            { id: 115, code: "WAD -AP- 112", name: "Aluminium Profile WAD 112DH", description: "Aluminium Profile WAD 112DH", category: "ALUMINIUM PROFILES", quantity: 1125, minQuantity: 113, location: "Storage D", unit: "Meter", unitPrice: 12350.00, value: 13893750.00, supplierId: 1, invoiceNumber: "INV-2023-115", purchaseDate: "2023-10-12" },
            { id: 116, code: "WAD -AP- 113", name: "Aluminium Profile WAD 113DI", description: "Aluminium Profile WAD 113DI", category: "ALUMINIUM PROFILES", quantity: 1135, minQuantity: 114, location: "Storage D", unit: "Meter", unitPrice: 12450.00, value: 14130750.00, supplierId: 1, invoiceNumber: "INV-2023-116", purchaseDate: "2023-10-12" },
            { id: 117, code: "WAD -AP- 114", name: "Aluminium Profile WAD 114DJ", description: "Aluminium Profile WAD 114DJ", category: "ALUMINIUM PROFILES", quantity: 1145, minQuantity: 115, location: "Storage D", unit: "Meter", unitPrice: 12550.00, value: 14369750.00, supplierId: 1, invoiceNumber: "INV-2023-117", purchaseDate: "2023-10-12" },
            { id: 118, code: "WAD -AP- 115", name: "Aluminium Profile WAD 115DK", description: "Aluminium Profile WAD 115DK", category: "ALUMINIUM PROFILES", quantity: 1155, minQuantity: 116, location: "Storage D", unit: "Meter", unitPrice: 12650.00, value: 14610750.00, supplierId: 1, invoiceNumber: "INV-2023-118", purchaseDate: "2023-10-12" },
            { id: 119, code: "WAD -AP- 116", name: "Aluminium Profile WAD 116DL", description: "Aluminium Profile WAD 116DL", category: "ALUMINIUM PROFILES", quantity: 1165, minQuantity: 117, location: "Storage D", unit: "Meter", unitPrice: 12750.00, value: 14853750.00, supplierId: 1, invoiceNumber: "INV-2023-119", purchaseDate: "2023-10-12" },
            { id: 120, code: "WAD -AP- 117", name: "Aluminium Profile WAD 117DM", description: "Aluminium Profile WAD 117DM", category: "ALUMINIUM PROFILES", quantity: 1175, minQuantity: 118, location: "Storage D", unit: "Meter", unitPrice: 12850.00, value: 15098750.00, supplierId: 1, invoiceNumber: "INV-2023-120", purchaseDate: "2023-10-12" },
            { id: 121, code: "WAD -AP- 118", name: "Aluminium Profile WAD 118DN", description: "Aluminium Profile WAD 118DN", category: "ALUMINIUM PROFILES", quantity: 1185, minQuantity: 119, location: "Storage D", unit: "Meter", unitPrice: 12950.00, value: 15345750.00, supplierId: 1, invoiceNumber: "INV-2023-121", purchaseDate: "2023-10-12" },
            { id: 122, code: "WAD -AP- 119", name: "Aluminium Profile WAD 119DO", description: "Aluminium Profile WAD 119DO", category: "ALUMINIUM PROFILES", quantity: 1195, minQuantity: 120, location: "Storage D", unit: "Meter", unitPrice: 13050.00, value: 15594750.00, supplierId: 1, invoiceNumber: "INV-2023-122", purchaseDate: "2023-10-12" },
            { id: 123, code: "WAD -AP- 120", name: "Aluminium Profile WAD 120DP", description: "Aluminium Profile WAD 120DP", category: "ALUMINIUM PROFILES", quantity: 1205, minQuantity: 121, location: "Storage D", unit: "Meter", unitPrice: 13150.00, value: 15845750.00, supplierId: 1, invoiceNumber: "INV-2023-123", purchaseDate: "2023-10-12" },
            { id: 124, code: "WAD -AP- 121", name: "Aluminium Profile WAD 121DQ", description: "Aluminium Profile WAD 121DQ", category: "ALUMINIUM PROFILES", quantity: 1215, minQuantity: 122, location: "Storage D", unit: "Meter", unitPrice: 13250.00, value: 16098750.00, supplierId: 1, invoiceNumber: "INV-2023-124", purchaseDate: "2023-10-12" },
            { id: 125, code: "WAD -AP- 122", name: "Aluminium Profile WAD 122DR", description: "Aluminium Profile WAD 122DR", category: "ALUMINIUM PROFILES", quantity: 1225, minQuantity: 123, location: "Storage D", unit: "Meter", unitPrice: 13350.00, value: 16353750.00, supplierId: 1, invoiceNumber: "INV-2023-125", purchaseDate: "2023-10-12" },
            { id: 126, code: "WAD -AP- 123", name: "Aluminium Profile WAD 123DS", description: "Aluminium Profile WAD 123DS", category: "ALUMINIUM PROFILES", quantity: 1235, minQuantity: 124, location: "Storage D", unit: "Meter", unitPrice: 13450.00, value: 16610750.00, supplierId: 1, invoiceNumber: "INV-2023-126", purchaseDate: "2023-10-12" },
            { id: 127, code: "WAD -AP- 124", name: "Aluminium Profile WAD 124DT", description: "Aluminium Profile WAD 124DT", category: "ALUMINIUM PROFILES", quantity: 1245, minQuantity: 125, location: "Storage D", unit: "Meter", unitPrice: 13550.00, value: 16869750.00, supplierId: 1, invoiceNumber: "INV-2023-127", purchaseDate: "2023-10-12" },
            { id: 128, code: "WAD -AP- 125", name: "Aluminium Profile WAD 125DU", description: "Aluminium Profile WAD 125DU", category: "ALUMINIUM PROFILES", quantity: 1255, minQuantity: 126, location: "Storage D", unit: "Meter", unitPrice: 13650.00, value: 17130750.00, supplierId: 1, invoiceNumber: "INV-2023-128", purchaseDate: "2023-10-12" },
            { id: 129, code: "WAD -AP- 126", name: "Aluminium Profile WAD 126DV", description: "Aluminium Profile WAD 126DV", category: "ALUMINIUM PROFILES", quantity: 1265, minQuantity: 127, location: "Storage D", unit: "Meter", unitPrice: 13750.00, value: 17393750.00, supplierId: 1, invoiceNumber: "INV-2023-129", purchaseDate: "2023-10-12" },
            { id: 130, code: "WAD -AP- 127", name: "Aluminium Profile WAD 127DW", description: "Aluminium Profile WAD 127DW", category: "ALUMINIUM PROFILES", quantity: 1275, minQuantity: 128, location: "Storage D", unit: "Meter", unitPrice: 13850.00, value: 17658750.00, supplierId: 1, invoiceNumber: "INV-2023-130", purchaseDate: "2023-10-12" },
            { id: 131, code: "WAD -AP- 128", name: "Aluminium Profile WAD 128DX", description: "Aluminium Profile WAD 128DX", category: "ALUMINIUM PROFILES", quantity: 1285, minQuantity: 129, location: "Storage D", unit: "Meter", unitPrice: 13950.00, value: 17925750.00, supplierId: 1, invoiceNumber: "INV-2023-131", purchaseDate: "2023-10-12" },
            { id: 132, code: "WAD -AP- 129", name: "Aluminium Profile WAD 129DY", description: "Aluminium Profile WAD 129DY", category: "ALUMINIUM PROFILES", quantity: 1295, minQuantity: 130, location: "Storage D", unit: "Meter", unitPrice: 14050.00, value: 18194750.00, supplierId: 1, invoiceNumber: "INV-2023-132", purchaseDate: "2023-10-12" },
            { id: 133, code: "WAD -AP- 130", name: "Aluminium Profile WAD 130DZ", description: "Aluminium Profile WAD 130DZ", category: "ALUMINIUM PROFILES", quantity: 1305, minQuantity: 131, location: "Storage D", unit: "Meter", unitPrice: 14150.00, value: 18465750.00, supplierId: 1, invoiceNumber: "INV-2023-133", purchaseDate: "2023-10-12" },
            { id: 134, code: "WAD -AP- 131", name: "Aluminium Profile WAD 131EA", description: "Aluminium Profile WAD 131EA", category: "ALUMINIUM PROFILES", quantity: 1315, minQuantity: 132, location: "Storage D", unit: "Meter", unitPrice: 14250.00, value: 18738750.00, supplierId: 1, invoiceNumber: "INV-2023-134", purchaseDate: "2023-10-12" },
            { id: 135, code: "WAD -AP- 132", name: "Aluminium Profile WAD 132EB", description: "Aluminium Profile WAD 132EB", category: "ALUMINIUM PROFILES", quantity: 1325, minQuantity: 133, location: "Storage D", unit: "Meter", unitPrice: 14350.00, value: 19013750.00, supplierId: 1, invoiceNumber: "INV-2023-135", purchaseDate: "2023-10-12" },
            { id: 136, code: "WAD -AP- 133", name: "Aluminium Profile WAD 133EC", description: "Aluminium Profile WAD 133EC", category: "ALUMINIUM PROFILES", quantity: 1335, minQuantity: 134, location: "Storage D", unit: "Meter", unitPrice: 14450.00, value: 19290750.00, supplierId: 1, invoiceNumber: "INV-2023-136", purchaseDate: "2023-10-12" },
            { id: 137, code: "WAD -AP- 134", name: "Aluminium Profile WAD 134ED", description: "Aluminium Profile WAD 134ED", category: "ALUMINIUM PROFILES", quantity: 1345, minQuantity: 135, location: "Storage D", unit: "Meter", unitPrice: 14550.00, value: 19569750.00, supplierId: 1, invoiceNumber: "INV-2023-137", purchaseDate: "2023-10-12" },
            { id: 138, code: "WAD -AP- 135", name: "Aluminium Profile WAD 135EE", description: "Aluminium Profile WAD 135EE", category: "ALUMINIUM PROFILES", quantity: 1355, minQuantity: 136, location: "Storage D", unit: "Meter", unitPrice: 14650.00, value: 19850750.00, supplierId: 1, invoiceNumber: "INV-2023-138", purchaseDate: "2023-10-12" },
            { id: 139, code: "WAD -AP- 136", name: "Aluminium Profile WAD 136EF", description: "Aluminium Profile WAD 136EF", category: "ALUMINIUM PROFILES", quantity: 1365, minQuantity: 137, location: "Storage D", unit: "Meter", unitPrice: 14750.00, value: 20133750.00, supplierId: 1, invoiceNumber: "INV-2023-139", purchaseDate: "2023-10-12" },
            { id: 140, code: "WAD -AP- 137", name: "Aluminium Profile WAD 137EG", description: "Aluminium Profile WAD 137EG", category: "ALUMINIUM PROFILES", quantity: 1375, minQuantity: 138, location: "Storage D", unit: "Meter", unitPrice: 14850.00, value: 20418750.00, supplierId: 1, invoiceNumber: "INV-2023-140", purchaseDate: "2023-10-12" },
            { id: 141, code: "WAD -AP- 138", name: "Aluminium Profile WAD 138EH", description: "Aluminium Profile WAD 138EH", category: "ALUMINIUM PROFILES", quantity: 1385, minQuantity: 139, location: "Storage D", unit: "Meter", unitPrice: 14950.00, value: 20705750.00, supplierId: 1, invoiceNumber: "INV-2023-141", purchaseDate: "2023-10-12" },
            { id: 142, code: "WAD -AP- 139", name: "Aluminium Profile WAD 139EI", description: "Aluminium Profile WAD 139EI", category: "ALUMINIUM PROFILES", quantity: 1395, minQuantity: 140, location: "Storage D", unit: "Meter", unitPrice: 15050.00, value: 20994750.00, supplierId: 1, invoiceNumber: "INV-2023-142", purchaseDate: "2023-10-12" },
            { id: 143, code: "WAD -AP- 140", name: "Aluminium Profile WAD 140EJ", description: "Aluminium Profile WAD 140EJ", category: "ALUMINIUM PROFILES", quantity: 1405, minQuantity: 141, location: "Storage D", unit: "Meter", unitPrice: 15150.00, value: 21285750.00, supplierId: 1, invoiceNumber: "INV-2023-143", purchaseDate: "2023-10-12" },
            { id: 144, code: "WAD -AP- 141", name: "Aluminium Profile WAD 141EK", description: "Aluminium Profile WAD 141EK", category: "ALUMINIUM PROFILES", quantity: 1415, minQuantity: 142, location: "Storage D", unit: "Meter", unitPrice: 15250.00, value: 21578750.00, supplierId: 1, invoiceNumber: "INV-2023-144", purchaseDate: "2023-10-12" },
            { id: 145, code: "WAD -AP- 142", name: "Aluminium Profile WAD 142EL", description: "Aluminium Profile WAD 142EL", category: "ALUMINIUM PROFILES", quantity: 1425, minQuantity: 143, location: "Storage D", unit: "Meter", unitPrice: 15350.00, value: 21873750.00, supplierId: 1, invoiceNumber: "INV-2023-145", purchaseDate: "2023-10-12" },
            { id: 146, code: "WAD -AP- 143", name: "Aluminium Profile WAD 143EM", description: "Aluminium Profile WAD 143EM", category: "ALUMINIUM PROFILES", quantity: 1435, minQuantity: 144, location: "Storage D", unit: "Meter", unitPrice: 15450.00, value: 22170750.00, supplierId: 1, invoiceNumber: "INV-2023-146", purchaseDate: "2023-10-12" },
            { id: 147, code: "WAD -AP- 144", name: "Aluminium Profile WAD 144EN", description: "Aluminium Profile WAD 144EN", category: "ALUMINIUM PROFILES", quantity: 1445, minQuantity: 145, location: "Storage D", unit: "Meter", unitPrice: 15550.00, value: 22469750.00, supplierId: 1, invoiceNumber: "INV-2023-147", purchaseDate: "2023-10-12" },
            { id: 148, code: "WAD -AP- 145", name: "Aluminium Profile WAD 145EO", description: "Aluminium Profile WAD 145EO", category: "ALUMINIUM PROFILES", quantity: 1455, minQuantity: 146, location: "Storage D", unit: "Meter", unitPrice: 15650.00, value: 22770750.00, supplierId: 1, invoiceNumber: "INV-2023-148", purchaseDate: "2023-10-12" },
            { id: 149, code: "WAD -AP- 146", name: "Aluminium Profile WAD 146EP", description: "Aluminium Profile WAD 146EP", category: "ALUMINIUM PROFILES", quantity: 1465, minQuantity: 147, location: "Storage D", unit: "Meter", unitPrice: 15750.00, value: 23073750.00, supplierId: 1, invoiceNumber: "INV-2023-149", purchaseDate: "2023-10-12" },
            { id: 150, code: "WAD -AP- 147", name: "Aluminium Profile WAD 147EQ", description: "Aluminium Profile WAD 147EQ", category: "ALUMINIUM PROFILES", quantity: 1475, minQuantity: 148, location: "Storage D", unit: "Meter", unitPrice: 15850.00, value: 23378750.00, supplierId: 1, invoiceNumber: "INV-2023-150", purchaseDate: "2023-10-12" },
            { id: 151, code: "WAD -AP- 148", name: "Aluminium Profile WAD 148ER", description: "Aluminium Profile WAD 148ER", category: "ALUMINIUM PROFILES", quantity: 1485, minQuantity: 149, location: "Storage D", unit: "Meter", unitPrice: 15950.00, value: 23685750.00, supplierId: 1, invoiceNumber: "INV-2023-151", purchaseDate: "2023-10-12" },
            { id: 152, code: "WAD -AP- 149", name: "Aluminium Profile WAD 149ES", description: "Aluminium Profile WAD 149ES", category: "ALUMINIUM PROFILES", quantity: 1495, minQuantity: 150, location: "Storage D", unit: "Meter", unitPrice: 16050.00, value: 23994750.00, supplierId: 1, invoiceNumber: "INV-2023-152", purchaseDate: "2023-10-12" },
            { id: 153, code: "WAD -AP- 150", name: "Aluminium Profile WAD 150ET", description: "Aluminium Profile WAD 150ET", category: "ALUMINIUM PROFILES", quantity: 1505, minQuantity: 151, location: "Storage D", unit: "Meter", unitPrice: 16150.00, value: 24305750.00, supplierId: 1, invoiceNumber: "INV-2023-153", purchaseDate: "2023-10-12" },
            { id: 154, code: "WAD -AP- 151", name: "Aluminium Profile WAD 151EU", description: "Aluminium Profile WAD 151EU", category: "ALUMINIUM PROFILES", quantity: 1515, minQuantity: 152, location: "Storage D", unit: "Meter", unitPrice: 16250.00, value: 24618750.00, supplierId: 1, invoiceNumber: "INV-2023-154", purchaseDate: "2023-10-12" },
            { id: 155, code: "WAD -AP- 152", name: "Aluminium Profile WAD 152EV", description: "Aluminium Profile WAD 152EV", category: "ALUMINIUM PROFILES", quantity: 1525, minQuantity: 153, location: "Storage D", unit: "Meter", unitPrice: 16350.00, value: 24933750.00, supplierId: 1, invoiceNumber: "INV-2023-155", purchaseDate: "2023-10-12" },
            { id: 156, code: "WAD -AP- 153", name: "Aluminium Profile WAD 153EW", description: "Aluminium Profile WAD 153EW", category: "ALUMINIUM PROFILES", quantity: 1535, minQuantity: 154, location: "Storage D", unit: "Meter", unitPrice: 16450.00, value: 25250750.00, supplierId: 1, invoiceNumber: "INV-2023-156", purchaseDate: "2023-10-12" },
            { id: 157, code: "WAD -AP- 154", name: "Aluminium Profile WAD 154EX", description: "Aluminium Profile WAD 154EX", category: "ALUMINIUM PROFILES", quantity: 1545, minQuantity: 155, location: "Storage D", unit: "Meter", unitPrice: 16550.00, value: 25569750.00, supplierId: 1, invoiceNumber: "INV-2023-157", purchaseDate: "2023-10-12" },
            { id: 158, code: "WAD -AP- 155", name: "Aluminium Profile WAD 155EY", description: "Aluminium Profile WAD 155EY", category: "ALUMINIUM PROFILES", quantity: 1555, minQuantity: 156, location: "Storage D", unit: "Meter", unitPrice: 16650.00, value: 25890750.00, supplierId: 1, invoiceNumber: "INV-2023-158", purchaseDate: "2023-10-12" },
            { id: 159, code: "WAD -AP- 156", name: "Aluminium Profile WAD 156EZ", description: "Aluminium Profile WAD 156EZ", category: "ALUMINIUM PROFILES", quantity: 1565, minQuantity: 157, location: "Storage D", unit: "Meter", unitPrice: 16750.00, value: 26213750.00, supplierId: 1, invoiceNumber: "INV-2023-159", purchaseDate: "2023-10-12" },
            { id: 160, code: "WAD -AP- 157", name: "Aluminium Profile WAD 157FA", description: "Aluminium Profile WAD 157FA", category: "ALUMINIUM PROFILES", quantity: 1575, minQuantity: 158, location: "Storage D", unit: "Meter", unitPrice: 16850.00, value: 26538750.00, supplierId: 1, invoiceNumber: "INV-2023-160", purchaseDate: "2023-10-12" }
        ];

        let jobNumbers = [
            { id: 1, number: "JOB-2023-001", description: "Office Renovation", status: "Active" },
            { id: 2, number: "JOB-2023-002", description: "Network Installation", status: "Active" },
            { id: 3, number: "JOB-2023-003", description: "Security System Upgrade", status: "Completed" },
            { id: 4, number: "JOB-2023-004", description: "Server Room Setup", status: "Active" }
        ];

        let suppliers = [
            { 
                id: 1, 
                code: "SUP-001", 
                companyName: "Aluminium Suppliers Ltd", 
                contactPerson: "Rajesh Kumar", 
                phone: "+94 77 123 4567", 
                email: "rajesh@aluminiumsuppliers.lk", 
                address: "123 Industrial Zone, Colombo 10", 
                paymentTerms: "30", 
                status: "active",
                outstandingAmount: 250000.00,
                totalPurchases: 1200000.00,
                lastPaymentDate: "2023-10-15",
                lastPaymentAmount: 150000.00,
                itemsSupplied: 45,
                rating: 4.5
            },
            { 
                id: 2, 
                code: "SUP-002", 
                companyName: "Steel & Mesh Corp", 
                contactPerson: "Anil Perera", 
                phone: "+94 71 987 6543", 
                email: "anil@steelmesh.lk", 
                address: "456 Factory Road, Kurunegala", 
                paymentTerms: "60", 
                status: "active",
                outstandingAmount: 180000.00,
                totalPurchases: 850000.00,
                lastPaymentDate: "2023-10-10",
                lastPaymentAmount: 120000.00,
                itemsSupplied: 32,
                rating: 4.2
            },
            { 
                id: 3, 
                code: "SUP-003", 
                companyName: "Hardware World", 
                contactPerson: "Saman Silva", 
                phone: "+94 76 555 1234", 
                email: "saman@hardwareworld.lk", 
                address: "789 Main Street, Kandy", 
                paymentTerms: "30", 
                status: "active",
                outstandingAmount: 75000.00,
                totalPurchases: 450000.00,
                lastPaymentDate: "2023-10-20",
                lastPaymentAmount: 50000.00,
                itemsSupplied: 28,
                rating: 4.0
            },
            { 
                id: 4, 
                code: "SUP-004", 
                companyName: "Electrical Components Inc", 
                contactPerson: "Nimal Fernando", 
                phone: "+94 70 222 3333", 
                email: "nimal@electrical.lk", 
                address: "321 Tech Park, Gampaha", 
                paymentTerms: "cod", 
                status: "inactive",
                outstandingAmount: 0.00,
                totalPurchases: 300000.00,
                lastPaymentDate: "2023-09-30",
                lastPaymentAmount: 30000.00,
                itemsSupplied: 15,
                rating: 3.8
            }
        ];

        let supplierPayments = [
            { id: 1, supplierId: 1, date: "2023-10-15", amount: 150000.00, method: "bank", reference: "CHQ-001234", notes: "October payment" },
            { id: 2, supplierId: 2, date: "2023-10-10", amount: 120000.00, method: "cheque", reference: "CHQ-001235", notes: "Partial payment" },
            { id: 3, supplierId: 1, date: "2023-09-15", amount: 200000.00, method: "bank", reference: "TRF-987654", notes: "September payment" },
            { id: 4, supplierId: 3, date: "2023-10-20", amount: 50000.00, method: "cash", reference: "RC-001", notes: "Cash payment" }
        ];

        let mailMessages = [
            { 
                id: 1, 
                folder: "inbox", 
                sender: "Rajesh Kumar <rajesh@aluminiumsuppliers.lk>", 
                subject: "Invoice INV-2023-001 Payment Reminder", 
                body: "Dear Sir/Madam,\n\nThis is a friendly reminder that payment for invoice INV-2023-001 is due in 15 days. The outstanding amount is Rs. 250,000.00.\n\nPlease arrange for payment at your earliest convenience.\n\nBest regards,\nRajesh Kumar\nAluminium Suppliers Ltd", 
                date: "2023-10-25", 
                read: false,
                important: true,
                attachments: []
            },
            { 
                id: 2, 
                folder: "inbox", 
                sender: "Anil Perera <anil@steelmesh.lk>", 
                subject: "New Product Catalog", 
                body: "Hello,\n\nWe have updated our product catalog with new items. Please find the attached catalog.\n\nWe are also offering special discounts for bulk orders this month.\n\nRegards,\nAnil Perera", 
                date: "2023-10-24", 
                read: true,
                important: false,
                attachments: ["catalog.pdf"]
            },
            { 
                id: 3, 
                folder: "sent", 
                sender: "John Doe <john.doe@westernairducts.lk>", 
                to: "rajesh@aluminiumsuppliers.lk", 
                subject: "Order Confirmation - ORD-2023-045", 
                body: "Dear Rajesh,\n\nThis is to confirm our order for 50 units of Aluminum Egg Crate sheets as per our discussion.\n\nPlease deliver to our warehouse by November 15, 2023.\n\nThanks,\nJohn Doe", 
                date: "2023-10-20", 
                read: true,
                important: false,
                attachments: []
            },
            { 
                id: 4, 
                folder: "suppliers", 
                sender: "System <system@westernairducts.lk>", 
                subject: "Low Stock Alert - G.I.Mesh", 
                body: "Alert: G.I.Mesh (Green) 1/2*1/2 is running low. Current stock: 30 units, Minimum required: 5 units.\n\nPlease consider placing an order with Steel & Mesh Corp.\n\nAutomated Alert System", 
                date: "2023-10-23", 
                read: false,
                important: true,
                attachments: []
            }
        ];

        let issueHistory = [
            { id: 1, date: "2023-10-15", jobNumber: "JOB-2023-001", itemId: 1, itemCode: "WAD - OS - 001", itemName: "Aluminum Egg Crate sheet New", quantity: 2, issuedBy: "John Doe", notes: "For project managers" },
            { id: 2, date: "2023-10-16", jobNumber: "JOB-2023-002", itemId: 3, itemCode: "WAD - OS - 003", itemName: "Aluminium Mesh", quantity: 25, issuedBy: "Jane Smith", notes: "For network cabling" },
            { id: 3, date: "2023-10-17", jobNumber: "JOB-2023-004", itemId: 1, itemCode: "WAD - OS - 001", itemName: "Aluminum Egg Crate sheet New", quantity: 3, issuedBy: "Mike Johnson", notes: "For server administration" },
            { id: 4, date: "2023-10-18", jobNumber: "JOB-2023-001", itemId: 4, itemCode: "WAD -AP- 001", itemName: "Aluminium Profile WAD 01A", quantity: 10, issuedBy: "John Doe", notes: "For construction team" }
        ];

        // DOM elements
        const navLinks = document.querySelectorAll('.nav-item');
        const sections = {
            dashboard: document.getElementById('dashboard-section'),
            suppliers: document.getElementById('suppliers-section'),
            reports: document.getElementById('reports-section'),
            mail: document.getElementById('mail-section'),
            settings: document.getElementById('settings-section')
        };
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        const inventoryBody = document.getElementById('inventory-body');
        const jobsBody = document.getElementById('jobs-body');
        const suppliersBody = document.getElementById('suppliers-body');
        const historyBody = document.getElementById('history-body');
        const itemModal = document.getElementById('item-modal');
        const jobModal = document.getElementById('job-modal');
        const supplierModal = document.getElementById('supplier-modal');
        const composeMailModal = document.getElementById('compose-mail-modal');
        const paymentModal = document.getElementById('payment-modal');
        const addItemBtn = document.getElementById('add-item-btn');
        const cancelItemBtn = document.getElementById('cancel-item-btn');
        const addJobBtn = document.getElementById('add-job-btn');
        const cancelJobBtn = document.getElementById('cancel-job-btn');
        const addSupplierBtn = document.getElementById('add-supplier-btn');
        const cancelSupplierBtn = document.getElementById('cancel-supplier-btn');
        const composeMailBtn = document.getElementById('compose-mail-btn');
        const cancelMailBtn = document.getElementById('cancel-mail-btn');
        const sendMailBtn = document.getElementById('send-mail-btn');
        const saveDraftBtn = document.getElementById('save-draft-btn');
        const cancelPaymentBtn = document.getElementById('cancel-payment-btn');
        const itemFormElement = document.getElementById('itemForm');
        const jobFormElement = document.getElementById('jobForm');
        const supplierFormElement = document.getElementById('supplierForm');
        const composeMailForm = document.getElementById('composeMailForm');
        const paymentForm = document.getElementById('paymentForm');
        const issueForm = document.getElementById('issueForm');
        const jobNumberSelect = document.getElementById('job-number');
        const issueItemSelect = document.getElementById('issue-item');
        const availableQuantityDiv = document.getElementById('available-quantity');
        const issueQuantityInput = document.getElementById('issue-quantity');
        const successMessage = document.getElementById('success-message');
        const errorMessage = document.getElementById('error-message');
        const issueSuccessMessage = document.getElementById('issue-success-message');
        const issueErrorMessage = document.getElementById('issue-error-message');
        const jobSuccessMessage = document.getElementById('job-success-message');
        const jobErrorMessage = document.getElementById('job-error-message');
        const supplierSuccessMessage = document.getElementById('supplier-success-message');
        const supplierErrorMessage = document.getElementById('supplier-error-message');
        const logoutModal = document.getElementById('logout-modal');
        const logoutLink = document.getElementById('logout-link');
        const confirmLogout = document.getElementById('confirm-logout');
        const cancelLogout = document.getElementById('cancel-logout');
        const generateReportBtn = document.getElementById('generate-report');
        const reportResults = document.getElementById('report-results');
        const userPreferencesForm = document.getElementById('user-preferences');
        const systemConfigForm = document.getElementById('system-config');
        const backupDbBtn = document.getElementById('backup-db');
        const restoreDbBtn = document.getElementById('restore-db');
        const clearDataBtn = document.getElementById('clear-data');
        const dbSuccessMessage = document.getElementById('db-success-message');
        const dbErrorMessage = document.getElementById('db-error-message');
        const fab = document.getElementById('fab');
        const mailList = document.getElementById('mail-list');
        const mailDetail = document.getElementById('mail-detail');
        const refreshMailBtn = document.getElementById('refresh-mail');
        const deleteMailBtn = document.getElementById('delete-mail');
        const mailFolderTitle = document.getElementById('mail-folder-title');
        const inboxCount = document.getElementById('inbox-count');

        // Search elements
        const inventorySearch = document.getElementById('inventory-search');
        const inventoryCategoryFilter = document.getElementById('inventory-category-filter');
        const inventorySupplierFilter = document.getElementById('inventory-supplier-filter');
        const inventoryStatusFilter = document.getElementById('inventory-status-filter');
        const clearInventorySearch = document.getElementById('clear-inventory-search');
        const inventoryResultsInfo = document.getElementById('inventory-results-info');
        
        const issueItemSearch = document.getElementById('issue-item-search');
        const issueCategoryFilter = document.getElementById('issue-category-filter');
        const clearIssueSearch = document.getElementById('clear-issue-search');
        
        const jobSearch = document.getElementById('job-search');
        const jobStatusFilter = document.getElementById('job-status-filter');
        const clearJobSearch = document.getElementById('clear-job-search');
        const jobResultsInfo = document.getElementById('job-results-info');
        
        const supplierSearch = document.getElementById('supplier-search');
        const supplierStatusFilter = document.getElementById('supplier-status-filter');
        const clearSupplierSearch = document.getElementById('clear-supplier-search');
        const supplierResultsInfo = document.getElementById('supplier-results-info');
        
        const historySearch = document.getElementById('history-search');
        const historyDateFrom = document.getElementById('history-date-from');
        const historyDateTo = document.getElementById('history-date-to');
        const searchHistoryBtn = document.getElementById('search-history');
        const clearHistoryBtn = document.getElementById('clear-history');
        const historyResultsInfo = document.getElementById('history-results-info');

        // Close modal buttons
        const closeModalButtons = document.querySelectorAll('.close-modal');

        // Current mail folder
        let currentMailFolder = 'inbox';
        let selectedMailId = null;

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            updateDashboard();
            populateCategoryFilters();
            populateSupplierFilters();
            renderInventory();
            renderJobNumbers();
            renderSuppliers();
            renderIssueHistory();
            populateJobNumberSelect();
            populateIssueItemSelect();
            populateJobFilter();
            populateMailToSelect();
            loadMail(currentMailFolder);
            
            // Set today's date for date fields
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('history-date-to').value = today;
            document.getElementById('date-to').value = today;
            const lastMonth = new Date();
            lastMonth.setDate(lastMonth.getDate() - 30);
            document.getElementById('date-from').value = lastMonth.toISOString().split('T')[0];
            document.getElementById('history-date-from').value = lastMonth.toISOString().split('T')[0];
            document.getElementById('item-purchase-date').value = today;
            document.getElementById('payment-date').value = today;
            
            // Event listeners for navigation
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetSection = this.getAttribute('data-tab');
                    if (targetSection) {
                        activateSection(targetSection);
                        // Update active nav link
                        navLinks.forEach(navLink => navLink.classList.remove('active'));
                        this.classList.add('active');
                        
                        // Hide FAB on reports and settings
                        if (targetSection === 'reports' || targetSection === 'settings' || targetSection === 'mail') {
                            fab.style.display = 'none';
                        } else {
                            fab.style.display = 'flex';
                        }
                    }
                });
            });
            
            // Event listeners for tabs
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    activateTab(tabId);
                });
            });
            
            // Event listeners for forms
            addItemBtn.addEventListener('click', showItemForm);
            cancelItemBtn.addEventListener('click', hideItemForm);
            addJobBtn.addEventListener('click', showJobForm);
            cancelJobBtn.addEventListener('click', hideJobForm);
            addSupplierBtn.addEventListener('click', showSupplierForm);
            cancelSupplierBtn.addEventListener('click', hideSupplierForm);
            composeMailBtn.addEventListener('click', showComposeMailForm);
            cancelMailBtn.addEventListener('click', hideComposeMailForm);
            saveDraftBtn.addEventListener('click', saveMailAsDraft);
            cancelPaymentBtn.addEventListener('click', hidePaymentForm);
            itemFormElement.addEventListener('submit', handleItemSubmit);
            jobFormElement.addEventListener('submit', handleJobSubmit);
            supplierFormElement.addEventListener('submit', handleSupplierSubmit);
            composeMailForm.addEventListener('submit', handleMailSubmit);
            paymentForm.addEventListener('submit', handlePaymentSubmit);
            issueForm.addEventListener('submit', handleIssueSubmit);
            issueItemSelect.addEventListener('change', updateAvailableQuantity);
            
            // Event listeners for inventory search
            inventorySearch.addEventListener('input', filterInventory);
            inventoryCategoryFilter.addEventListener('change', filterInventory);
            inventorySupplierFilter.addEventListener('change', filterInventory);
            inventoryStatusFilter.addEventListener('change', filterInventory);
            clearInventorySearch.addEventListener('click', clearInventoryFilters);
            
            // Event listeners for issue search
            issueItemSearch.addEventListener('input', filterIssueItems);
            issueCategoryFilter.addEventListener('change', filterIssueItems);
            clearIssueSearch.addEventListener('click', clearIssueFilters);
            
            // Event listeners for job search
            jobSearch.addEventListener('input', filterJobs);
            jobStatusFilter.addEventListener('change', filterJobs);
            clearJobSearch.addEventListener('click', clearJobFilters);
            
            // Event listeners for supplier search
            supplierSearch.addEventListener('input', filterSuppliers);
            supplierStatusFilter.addEventListener('change', filterSuppliers);
            clearSupplierSearch.addEventListener('click', clearSupplierFilters);
            
            // Event listeners for history search
            searchHistoryBtn.addEventListener('click', searchHistory);
            clearHistoryBtn.addEventListener('click', clearHistorySearch);
            
            // Event listeners for mail
            document.querySelectorAll('[data-mail-folder]').forEach(button => {
                button.addEventListener('click', function() {
                    const folder = this.getAttribute('data-mail-folder');
                    loadMail(folder);
                });
            });
            
            document.querySelectorAll('[data-mail-action]').forEach(button => {
                button.addEventListener('click', function() {
                    const action = this.getAttribute('data-mail-action');
                    handleMailAction(action);
                });
            });
            
            refreshMailBtn.addEventListener('click', () => loadMail(currentMailFolder));
            deleteMailBtn.addEventListener('click', deleteSelectedMail);
            
            // Event listeners for logout
            logoutLink.addEventListener('click', function(e) {
                e.preventDefault();
                logoutModal.style.display = 'flex';
            });
            
            confirmLogout.addEventListener('click', performLogout);
            cancelLogout.addEventListener('click', function() {
                logoutModal.style.display = 'none';
            });
            
            // Event listeners for reports
            generateReportBtn.addEventListener('click', generateReport);
            
            // Event listeners for settings
            userPreferencesForm.addEventListener('submit', saveUserPreferences);
            systemConfigForm.addEventListener('submit', saveSystemConfig);
            backupDbBtn.addEventListener('click', backupDatabase);
            restoreDbBtn.addEventListener('click', restoreDatabase);
            clearDataBtn.addEventListener('click', clearAllData);
            
            // Event listeners for modals
            closeModalButtons.forEach(button => {
                button.addEventListener('click', function() {
                    this.closest('.modal').style.display = 'none';
                });
            });
            
            // Close modal when clicking outside
            window.addEventListener('click', function(event) {
                if (event.target.classList.contains('modal')) {
                    event.target.style.display = 'none';
                }
            });
            
            // Event listener for FAB
            fab.addEventListener('click', function() {
                const activeTab = document.querySelector('.tab.active').getAttribute('data-tab');
                if (activeTab === 'inventory') {
                    showItemForm();
                } else if (activeTab === 'jobs') {
                    showJobForm();
                } else if (activeTab === 'suppliers-tab') {
                    showSupplierForm();
                }
            });
        });

        // Populate category filters
        function populateCategoryFilters() {
            const categories = [...new Set(inventory.map(item => item.category))];
            const categorySelects = [
                document.getElementById('inventory-category-filter'),
                document.getElementById('issue-category-filter'),
                document.getElementById('item-category')
            ];
            
            categorySelects.forEach(select => {
                if (select) {
                    // Clear existing options except the first one
                    while (select.options.length > 1) {
                        select.remove(1);
                    }
                    
                    // Add categories
                    categories.forEach(category => {
                        const option = document.createElement('option');
                        option.value = category;
                        option.textContent = category;
                        select.appendChild(option);
                    });
                    
                    // Add option to add new category
                    const addOption = document.createElement('option');
                    addOption.value = "add-new";
                    addOption.textContent = "+ Add New Category";
                    addOption.style.color = "var(--primary)";
                    addOption.style.fontWeight = "bold";
                    select.appendChild(addOption);
                }
            });
        }

        // Populate supplier filters
        function populateSupplierFilters() {
            const supplierSelects = [
                document.getElementById('inventory-supplier-filter'),
                document.getElementById('item-supplier'),
                document.getElementById('mail-to')
            ];
            
            supplierSelects.forEach(select => {
                if (select) {
                    // Clear existing options except the first one
                    while (select.options.length > 1) {
                        select.remove(1);
                    }
                    
                    // Add suppliers
                    suppliers.forEach(supplier => {
                        const option = document.createElement('option');
                        option.value = supplier.id;
                        option.textContent = `${supplier.companyName} (${supplier.contactPerson})`;
                        select.appendChild(option);
                    });
                    
                    // For mail-to, add additional options
                    if (select.id === 'mail-to') {
                        // Add internal users
                        const internalUsers = [
                            {id: 'admin', name: 'Administrator', email: 'admin@westernairducts.lk'},
                            {id: 'manager', name: 'Manager', email: 'manager@westernairducts.lk'},
                            {id: 'store', name: 'Store Keeper', email: 'store@westernairducts.lk'}
                        ];
                        
                        const groupOption = document.createElement('optgroup');
                        groupOption.label = "Internal";
                        select.appendChild(groupOption);
                        
                        internalUsers.forEach(user => {
                            const option = document.createElement('option');
                            option.value = user.email;
                            option.textContent = `${user.name} (${user.email})`;
                            groupOption.appendChild(option);
                        });
                    }
                }
            });
        }

        // Populate mail to select
        function populateMailToSelect() {
            const mailToSelect = document.getElementById('mail-to');
            if (!mailToSelect) return;
            
            // Keep the first option
            while (mailToSelect.options.length > 1) {
                mailToSelect.remove(1);
            }
            
            // Add supplier group
            const supplierGroup = document.createElement('optgroup');
            supplierGroup.label = "Suppliers";
            mailToSelect.appendChild(supplierGroup);
            
            suppliers.forEach(supplier => {
                const option = document.createElement('option');
                option.value = supplier.email;
                option.textContent = `${supplier.companyName} - ${supplier.contactPerson} (${supplier.email})`;
                supplierGroup.appendChild(option);
            });
            
            // Add internal group
            const internalGroup = document.createElement('optgroup');
            internalGroup.label = "Internal";
            mailToSelect.appendChild(internalGroup);
            
            const internalUsers = [
                {email: 'admin@westernairducts.lk', name: 'Administrator'},
                {email: 'manager@westernairducts.lk', name: 'Manager'},
                {email: 'store@westernairducts.lk', name: 'Store Keeper'},
                {email: 'accounts@westernairducts.lk', name: 'Accounts Department'}
            ];
            
            internalUsers.forEach(user => {
                const option = document.createElement('option');
                option.value = user.email;
                option.textContent = `${user.name} (${user.email})`;
                internalGroup.appendChild(option);
            });
        }

        // Section navigation
        function activateSection(sectionId) {
            Object.values(sections).forEach(section => {
                section.style.display = 'none';
            });
            
            if (sections[sectionId]) {
                sections[sectionId].style.display = 'block';
            }
        }

        // Tab navigation
        function activateTab(tabId) {
            tabs.forEach(tab => {
                if (tab.getAttribute('data-tab') === tabId) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });
            
            tabContents.forEach(content => {
                if (content.id === `${tabId}-tab`) {
                    content.classList.add('active');
                } else {
                    content.classList.remove('active');
                }
            });
        }

        // Update dashboard statistics
        function updateDashboard() {
            const totalItems = inventory.length;
            const lowStockItems = inventory.filter(item => item.quantity <= item.minQuantity).length;
            const today = new Date().toISOString().split('T')[0];
            const issuedToday = issueHistory.filter(issue => issue.date === today).length;
            const activeJobs = jobNumbers.filter(job => job.status === 'Active').length;
            const totalStockValue = inventory.reduce((sum, item) => sum + (item.value || 0), 0);
            const totalSupplierOutstanding = suppliers.reduce((sum, supplier) => sum + (supplier.outstandingAmount || 0), 0);
            
            document.getElementById('total-items').textContent = totalItems;
            document.getElementById('low-stock').textContent = lowStockItems;
            document.getElementById('issued-today').textContent = issuedToday;
            document.getElementById('active-jobs').textContent = activeJobs;
            document.getElementById('total-value').textContent = `Rs. ${totalStockValue.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            document.getElementById('supplier-outstanding').textContent = `Rs. ${totalSupplierOutstanding.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            
            // Update inbox count
            const unreadCount = mailMessages.filter(mail => mail.folder === 'inbox' && !mail.read).length;
            inboxCount.textContent = unreadCount > 0 ? unreadCount.toString() : '';
        }

        // Render inventory table
        function renderInventory(items = inventory) {
            inventoryBody.innerHTML = '';
            
            if (items.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="11" style="text-align: center; padding: 2rem;">No items found</td>`;
                inventoryBody.appendChild(row);
                return;
            }
            
            items.forEach(item => {
                const statusClass = item.quantity <= item.minQuantity ? 'status-low' : 'status-ok';
                const statusText = item.quantity <= item.minQuantity ? 'Low Stock' : 'In Stock';
                const supplier = suppliers.find(s => s.id === item.supplierId);
                const supplierName = supplier ? supplier.companyName : 'Unknown';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td title="${item.code}">${truncateText(item.code, 15)}</td>
                    <td title="${item.name}">${truncateText(item.name, 20)}</td>
                    <td title="${item.category}">${truncateText(item.category, 15)}</td>
                    <td title="${supplierName}">${truncateText(supplierName, 15)}</td>
                    <td><span class="invoice-badge">${item.invoiceNumber || 'N/A'}</span></td>
                    <td>${item.unit}</td>
                    <td class="currency">${formatCurrency(item.unitPrice)}</td>
                    <td>${item.quantity}</td>
                    <td><span class="status ${statusClass}">${statusText}</span></td>
                    <td class="currency">${formatCurrency(item.value)}</td>
                    <td>
                        <button class="action-btn edit-btn" data-id="${item.id}" title="Edit"><i class="fas fa-edit"></i></button>
                        <button class="action-btn delete-btn" data-id="${item.id}" title="Delete"><i class="fas fa-trash"></i></button>
                        <button class="action-btn issue-btn" data-id="${item.id}" title="Issue Item"><i class="fas fa-paper-plane"></i></button>
                    </td>
                `;
                inventoryBody.appendChild(row);
            });
            
            // Add event listeners to action buttons
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const itemId = parseInt(this.getAttribute('data-id'));
                    editItem(itemId);
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const itemId = parseInt(this.getAttribute('data-id'));
                    deleteItem(itemId);
                });
            });
            
            document.querySelectorAll('.issue-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const itemId = parseInt(this.getAttribute('data-id'));
                    activateTab('issue');
                    issueItemSelect.value = itemId;
                    updateAvailableQuantity();
                    issueItemSelect.focus();
                });
            });
        }

        // Format currency
        function formatCurrency(amount) {
            return `Rs. ${amount?.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}) || '0.00'}`;
        }

        // Truncate text with ellipsis
        function truncateText(text, maxLength) {
            if (!text) return 'N/A';
            if (text.length > maxLength) {
                return text.substring(0, maxLength) + '...';
            }
            return text;
        }

        // Render job numbers table
        function renderJobNumbers(jobs = jobNumbers) {
            jobsBody.innerHTML = '';
            
            if (jobs.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="4" style="text-align: center; padding: 2rem;">No jobs found</td>`;
                jobsBody.appendChild(row);
                return;
            }
            
            jobs.forEach(job => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td title="${job.number}">${truncateText(job.number, 15)}</td>
                    <td title="${job.description}">${truncateText(job.description, 30)}</td>
                    <td>${job.status}</td>
                    <td>
                        <button class="action-btn edit-btn" data-id="${job.id}" title="Edit"><i class="fas fa-edit"></i></button>
                        <button class="action-btn delete-btn" data-id="${job.id}" title="Delete"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                jobsBody.appendChild(row);
            });
            
            // Add event listeners to action buttons
            document.querySelectorAll('#jobs-body .edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const jobId = parseInt(this.getAttribute('data-id'));
                    editJob(jobId);
                });
            });
            
            document.querySelectorAll('#jobs-body .delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const jobId = parseInt(this.getAttribute('data-id'));
                    deleteJob(jobId);
                });
            });
        }

        // Render suppliers table
        function renderSuppliers(supplierList = suppliers) {
            suppliersBody.innerHTML = '';
            
            if (supplierList.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="9" style="text-align: center; padding: 2rem;">No suppliers found</td>`;
                suppliersBody.appendChild(row);
                return;
            }
            
            supplierList.forEach(supplier => {
                const statusClass = supplier.outstandingAmount > 0 ? 'status-overdue' : 'status-paid';
                const statusText = supplier.outstandingAmount > 0 ? `Rs. ${formatCurrency(supplier.outstandingAmount)}` : 'All Paid';
                const paymentStatus = supplier.outstandingAmount > 0 ? 
                    `<span class="outstanding-amount outstanding-due">${formatCurrency(supplier.outstandingAmount)}</span>` :
                    `<span class="outstanding-amount outstanding-paid">Paid</span>`;
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><span class="supplier-badge">${supplier.code}</span></td>
                    <td title="${supplier.companyName}">${truncateText(supplier.companyName, 20)}</td>
                    <td>${supplier.contactPerson}</td>
                    <td>${supplier.phone}</td>
                    <td title="${supplier.email}">${truncateText(supplier.email, 20)}</td>
                    <td class="text-right">${paymentStatus}</td>
                    <td><span class="status ${statusClass}">${supplier.outstandingAmount > 0 ? 'Payment Due' : 'Paid'}</span></td>
                    <td>${supplier.lastPaymentDate || 'N/A'}</td>
                    <td>
                        <button class="action-btn edit-btn" data-id="${supplier.id}" title="Edit"><i class="fas fa-edit"></i></button>
                        <button class="action-btn delete-btn" data-id="${supplier.id}" title="Delete"><i class="fas fa-trash"></i></button>
                        <button class="action-btn view-btn" data-id="${supplier.id}" title="View Details"><i class="fas fa-eye"></i></button>
                        <button class="action-btn mail-btn" data-id="${supplier.id}" title="Send Mail"><i class="fas fa-envelope"></i></button>
                        ${supplier.outstandingAmount > 0 ? 
                            `<button class="action-btn" style="background-color: rgba(76, 201, 240, 0.1); color: var(--success);" data-id="${supplier.id}" title="Record Payment"><i class="fas fa-money-check-alt"></i></button>` : 
                            ''}
                    </td>
                `;
                suppliersBody.appendChild(row);
            });
            
            // Add event listeners to action buttons
            document.querySelectorAll('#suppliers-body .edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const supplierId = parseInt(this.getAttribute('data-id'));
                    editSupplier(supplierId);
                });
            });
            
            document.querySelectorAll('#suppliers-body .delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const supplierId = parseInt(this.getAttribute('data-id'));
                    deleteSupplier(supplierId);
                });
            });
            
            document.querySelectorAll('#suppliers-body .view-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const supplierId = parseInt(this.getAttribute('data-id'));
                    viewSupplierDetails(supplierId);
                });
            });
            
            document.querySelectorAll('#suppliers-body .mail-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const supplierId = parseInt(this.getAttribute('data-id'));
                    sendMailToSupplier(supplierId);
                });
            });
            
            document.querySelectorAll('#suppliers-body .action-btn[title="Record Payment"]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const supplierId = parseInt(this.getAttribute('data-id'));
                    recordPayment(supplierId);
                });
            });
        }

        // Render issue history table
        function renderIssueHistory(history = issueHistory) {
            historyBody.innerHTML = '';
            
            if (history.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="7" style="text-align: center; padding: 2rem;">No issue history found</td>`;
                historyBody.appendChild(row);
                return;
            }
            
            history.forEach(issue => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${issue.date}</td>
                    <td>${issue.jobNumber}</td>
                    <td title="${issue.itemCode}">${truncateText(issue.itemCode, 15)}</td>
                    <td title="${issue.itemName}">${truncateText(issue.itemName, 20)}</td>
                    <td>${issue.quantity}</td>
                    <td>${issue.issuedBy}</td>
                    <td title="${issue.notes}">${truncateText(issue.notes, 30)}</td>
                `;
                historyBody.appendChild(row);
            });
        }

        // Populate job number select in issue form
        function populateJobNumberSelect() {
            jobNumberSelect.innerHTML = '<option value="">Select Job Number</option>';
            
            jobNumbers
                .filter(job => job.status === 'Active')
                .forEach(job => {
                    const option = document.createElement('option');
                    option.value = job.id;
                    option.textContent = job.number;
                    jobNumberSelect.appendChild(option);
                });
        }

        // Populate job filter in reports
        function populateJobFilter() {
            const jobFilter = document.getElementById('job-filter');
            jobFilter.innerHTML = '<option value="">All Jobs</option>';
            
            jobNumbers.forEach(job => {
                const option = document.createElement('option');
                option.value = job.id;
                option.textContent = job.number;
                jobFilter.appendChild(option);
            });
        }

        // Populate item select in issue form
        function populateIssueItemSelect() {
            issueItemSelect.innerHTML = '<option value="">Select Item</option>';
            
            inventory.forEach(item => {
                const option = document.createElement('option');
                option.value = item.id;
                option.textContent = `${item.code} - ${item.name} (${item.quantity} available)`;
                issueItemSelect.appendChild(option);
            });
        }

        // Update available quantity when item is selected
        function updateAvailableQuantity() {
            const itemId = parseInt(issueItemSelect.value);
            if (itemId) {
                const item = inventory.find(i => i.id === itemId);
                if (item) {
                    availableQuantityDiv.textContent = `Available: ${item.quantity}`;
                    issueQuantityInput.max = item.quantity;
                    // If the current value is greater than available quantity, reset to max
                    if (parseInt(issueQuantityInput.value) > item.quantity) {
                        issueQuantityInput.value = item.quantity || 1;
                    }
                    issueQuantityInput.min = 1;
                    issueQuantityInput.value = issueQuantityInput.value || 1;
                }
            } else {
                availableQuantityDiv.textContent = '';
                issueQuantityInput.value = '';
            }
        }

        // Load mail
        function loadMail(folder) {
            currentMailFolder = folder;
            mailFolderTitle.textContent = folder.charAt(0).toUpperCase() + folder.slice(1);
            mailList.innerHTML = '';
            mailDetail.style.display = 'none';
            mailList.style.display = 'block';
            selectedMailId = null;
            
            const folderMails = mailMessages.filter(mail => mail.folder === folder);
            
            if (folderMails.length === 0) {
                mailList.innerHTML = `
                    <div style="text-align: center; padding: 3rem; color: var(--gray);">
                        <i class="fas fa-inbox" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                        <p>No messages in ${folder}</p>
                    </div>
                `;
                return;
            }
            
            folderMails.forEach(mail => {
                const mailItem = document.createElement('div');
                mailItem.className = `mail-item ${mail.read ? '' : 'unread'} ${selectedMailId === mail.id ? 'selected' : ''}`;
                mailItem.dataset.id = mail.id;
                
                // Extract sender name and email
                const senderMatch = mail.sender.match(/(.*?)<(.*?)>/);
                const senderName = senderMatch ? senderMatch[1].trim() : mail.sender;
                const senderEmail = senderMatch ? senderMatch[2].trim() : '';
                
                mailItem.innerHTML = `
                    <div class="mail-preview">
                        <div style="flex: 1;">
                            <div class="mail-sender">${senderName}</div>
                            <div class="mail-subject">${mail.subject}</div>
                            <div class="mail-body-preview">${mail.body.substring(0, 100)}...</div>
                        </div>
                        <div class="mail-date">${formatDate(mail.date)}</div>
                    </div>
                    ${mail.important ? '<div style="margin-top: 0.5rem;"><i class="fas fa-star" style="color: #ffc107;"></i></div>' : ''}
                    ${mail.attachments && mail.attachments.length > 0 ? 
                        `<div style="margin-top: 0.5rem;"><i class="fas fa-paperclip"></i> ${mail.attachments.length} attachment(s)</div>` : ''}
                `;
                
                mailItem.addEventListener('click', function() {
                    viewMail(mail.id);
                });
                
                mailList.appendChild(mailItem);
            });
        }

        // Format date
        function formatDate(dateString) {
            const date = new Date(dateString);
            const today = new Date();
            const yesterday = new Date(today);
            yesterday.setDate(yesterday.getDate() - 1);
            
            if (date.toDateString() === today.toDateString()) {
                return date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            } else if (date.toDateString() === yesterday.toDateString()) {
                return 'Yesterday';
            } else {
                return date.toLocaleDateString();
            }
        }

        // View mail
        function viewMail(mailId) {
            const mail = mailMessages.find(m => m.id === mailId);
            if (!mail) return;
            
            // Mark as read
            mail.read = true;
            selectedMailId = mailId;
            
            // Update UI
            document.querySelectorAll('.mail-item').forEach(item => {
                item.classList.remove('selected');
                if (parseInt(item.dataset.id) === mailId) {
                    item.classList.add('selected');
                    item.classList.remove('unread');
                }
            });
            
            // Extract sender details
            const senderMatch = mail.sender.match(/(.*?)<(.*?)>/);
            const senderName = senderMatch ? senderMatch[1].trim() : mail.sender;
            const senderEmail = senderMatch ? senderMatch[2].trim() : '';
            
            // Show mail detail
            mailList.style.display = 'none';
            mailDetail.style.display = 'block';
            mailDetail.innerHTML = `
                <div class="mail-detail-header" style="border-bottom: 1px solid var(--light-gray); padding-bottom: 1rem; margin-bottom: 1rem;">
                    <h3>${mail.subject}</h3>
                    <div style="display: flex; justify-content: space-between; margin-top: 0.5rem;">
                        <div>
                            <div><strong>From:</strong> ${senderName} &lt;${senderEmail}&gt;</div>
                            ${mail.to ? `<div style="margin-top: 0.3rem;"><strong>To:</strong> ${mail.to}</div>` : ''}
                        </div>
                        <div class="mail-date">${new Date(mail.date).toLocaleString()}</div>
                    </div>
                </div>
                <div class="mail-detail-body" style="white-space: pre-wrap; line-height: 1.6; margin-bottom: 1.5rem;">
                    ${mail.body}
                </div>
                ${mail.attachments && mail.attachments.length > 0 ? `
                    <div class="mail-attachments" style="border-top: 1px solid var(--light-gray); padding-top: 1rem;">
                        <h4>Attachments (${mail.attachments.length})</h4>
                        <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem;">
                            ${mail.attachments.map(attachment => 
                                `<button class="secondary"><i class="fas fa-paperclip"></i> ${attachment}</button>`
                            ).join('')}
                        </div>
                    </div>
                ` : ''}
                <div class="mail-detail-actions" style="margin-top: 1.5rem; display: flex; gap: 0.5rem;">
                    <button class="secondary" id="reply-mail-btn"><i class="fas fa-reply"></i> Reply</button>
                    <button class="secondary" id="forward-mail-btn"><i class="fas fa-share"></i> Forward</button>
                    <button class="secondary" id="back-to-inbox-btn"><i class="fas fa-arrow-left"></i> Back to List</button>
                </div>
            `;
            
            // Add event listeners to buttons
            document.getElementById('back-to-inbox-btn').addEventListener('click', () => {
                mailDetail.style.display = 'none';
                mailList.style.display = 'block';
            });
            
            document.getElementById('reply-mail-btn').addEventListener('click', () => {
                replyToMail(mailId);
            });
            
            document.getElementById('forward-mail-btn').addEventListener('click', () => {
                forwardMail(mailId);
            });
            
            // Update inbox count
            updateDashboard();
        }

        // Reply to mail
        function replyToMail(mailId) {
            const mail = mailMessages.find(m => m.id === mailId);
            if (!mail) return;
            
            const senderMatch = mail.sender.match(/(.*?)<(.*?)>/);
            const senderEmail = senderMatch ? senderMatch[2].trim() : mail.sender;
            
            showComposeMailForm();
            document.getElementById('mail-to').value = senderEmail;
            document.getElementById('mail-subject').value = `Re: ${mail.subject}`;
            document.getElementById('mail-body').value = `\n\n--- Original Message ---\nFrom: ${mail.sender}\nDate: ${mail.date}\nSubject: ${mail.subject}\n\n${mail.body}`;
        }

        // Forward mail
        function forwardMail(mailId) {
            const mail = mailMessages.find(m => m.id === mailId);
            if (!mail) return;
            
            showComposeMailForm();
            document.getElementById('mail-subject').value = `Fwd: ${mail.subject}`;
            document.getElementById('mail-body').value = `\n\n--- Forwarded Message ---\nFrom: ${mail.sender}\nDate: ${mail.date}\nSubject: ${mail.subject}\n\n${mail.body}`;
        }

        // Handle mail action
        function handleMailAction(action) {
            switch(action) {
                case 'supplier-reminder':
                    showSupplierReminderForm();
                    break;
                case 'stock-alert':
                    sendLowStockAlert();
                    break;
                case 'order-confirmation':
                    showOrderConfirmationForm();
                    break;
            }
        }

        // Show supplier reminder form
        function showSupplierReminderForm() {
            showComposeMailForm();
            document.getElementById('mail-subject').value = 'Payment Reminder';
            document.getElementById('mail-body').value = 'Dear Supplier,\n\nThis is a friendly reminder regarding your outstanding payment. Please arrange for payment at your earliest convenience.\n\nBest regards,\nAccounts Department\nWestern Airducts Lanka (Pvt) Ltd';
        }

        // Send low stock alert
        function sendLowStockAlert() {
            const lowStockItems = inventory.filter(item => item.quantity <= item.minQuantity);
            if (lowStockItems.length === 0) {
                alert('No low stock items found.');
                return;
            }
            
            showComposeMailForm();
            document.getElementById('mail-to').value = 'store@westernairducts.lk';
            document.getElementById('mail-subject').value = 'Low Stock Alert';
            
            let body = 'Low Stock Alert:\n\n';
            lowStockItems.forEach(item => {
                body += `- ${item.code}: ${item.name} (Current: ${item.quantity}, Min: ${item.minQuantity})\n`;
            });
            body += '\nPlease place orders for these items.\n\nAutomated Alert System';
            
            document.getElementById('mail-body').value = body;
        }

        // Show order confirmation form
        function showOrderConfirmationForm() {
            showComposeMailForm();
            document.getElementById('mail-subject').value = 'Order Confirmation';
            document.getElementById('mail-body').value = 'Dear Supplier,\n\nThis is to confirm our order. Please find the details below:\n\nItem Details:\n- Item 1: [Please specify]\n- Quantity: [Please specify]\n- Delivery Date: [Please specify]\n\nPlease acknowledge receipt of this order.\n\nBest regards,\nPurchase Department\nWestern Airducts Lanka (Pvt) Ltd';
        }

        // Delete selected mail
        function deleteSelectedMail() {
            if (!selectedMailId) {
                alert('Please select a mail to delete.');
                return;
            }
            
            if (confirm('Are you sure you want to delete this mail?')) {
                const index = mailMessages.findIndex(m => m.id === selectedMailId);
                if (index !== -1) {
                    mailMessages.splice(index, 1);
                    loadMail(currentMailFolder);
                    updateDashboard();
                }
            }
        }

        // Show item form
        function showItemForm() {
            itemModal.style.display = 'flex';
            document.getElementById('item-id').value = '';
            document.getElementById('item-code').value = '';
            document.getElementById('item-name').value = '';
            document.getElementById('item-description').value = '';
            document.getElementById('item-supplier').value = '';
            document.getElementById('item-invoice').value = '';
            document.getElementById('item-category').value = '';
            document.getElementById('item-unit').value = '';
            document.getElementById('item-unit-price').value = '';
            document.getElementById('item-quantity').value = '';
            document.getElementById('item-min-quantity').value = '';
            document.getElementById('item-location').value = '';
            document.getElementById('item-purchase-date').value = new Date().toISOString().split('T')[0];
            
            // Focus on first input
            document.getElementById('item-code').focus();
        }

        // Hide item form
        function hideItemForm() {
            itemModal.style.display = 'none';
        }

        // Show job form
        function showJobForm() {
            jobModal.style.display = 'flex';
            document.getElementById('job-id').value = '';
            document.getElementById('job-number-input').value = '';
            document.getElementById('job-description').value = '';
            document.getElementById('job-status').value = 'Active';
            
            // Focus on first input
            document.getElementById('job-number-input').focus();
        }

        // Hide job form
        function hideJobForm() {
            jobModal.style.display = 'none';
        }

        // Show supplier form
        function showSupplierForm() {
            supplierModal.style.display = 'flex';
            document.getElementById('supplier-id').value = '';
            document.getElementById('supplier-code').value = '';
            document.getElementById('supplier-company').value = '';
            document.getElementById('supplier-contact').value = '';
            document.getElementById('supplier-phone').value = '';
            document.getElementById('supplier-email').value = '';
            document.getElementById('supplier-address').value = '';
            document.getElementById('supplier-payment-terms').value = '30';
            document.getElementById('supplier-status').value = 'active';
            
            // Focus on first input
            document.getElementById('supplier-code').focus();
        }

        // Hide supplier form
        function hideSupplierForm() {
            supplierModal.style.display = 'none';
        }

        // Show compose mail form
        function showComposeMailForm() {
            composeMailModal.style.display = 'flex';
            document.getElementById('mail-to').value = '';
            document.getElementById('mail-subject').value = '';
            document.getElementById('mail-body').value = '';
            document.getElementById('mail-attachment').value = '';
            
            // Focus on first input
            document.getElementById('mail-to').focus();
        }

        // Hide compose mail form
        function hideComposeMailForm() {
            composeMailModal.style.display = 'none';
        }

        // Save mail as draft
        function saveMailAsDraft(e) {
            e.preventDefault();
            const to = document.getElementById('mail-to').value;
            const subject = document.getElementById('mail-subject').value;
            const body = document.getElementById('mail-body').value;
            
            if (!to || !subject || !body) {
                alert('Please fill all required fields.');
                return;
            }
            
            const newId = mailMessages.length > 0 ? Math.max(...mailMessages.map(mail => mail.id)) + 1 : 1;
            const today = new Date().toISOString().split('T')[0];
            
            mailMessages.push({
                id: newId,
                folder: 'drafts',
                sender: 'John Doe <john.doe@westernairducts.lk>',
                to: to,
                subject: `[DRAFT] ${subject}`,
                body: body,
                date: today,
                read: true,
                important: false,
                attachments: []
            });
            
            hideComposeMailForm();
            alert('Mail saved as draft.');
            loadMail('drafts');
        }

        // Show payment form
        function recordPayment(supplierId) {
            const supplier = suppliers.find(s => s.id === supplierId);
            if (!supplier) return;
            
            paymentModal.style.display = 'flex';
            document.getElementById('payment-supplier-id').value = supplier.id;
            document.getElementById('payment-supplier-name').value = supplier.companyName;
            document.getElementById('payment-outstanding').value = formatCurrency(supplier.outstandingAmount);
            document.getElementById('payment-amount').value = '';
            document.getElementById('payment-method').value = 'bank';
            document.getElementById('payment-date').value = new Date().toISOString().split('T')[0];
            document.getElementById('payment-reference').value = '';
            document.getElementById('payment-notes').value = '';
            
            // Focus on amount input
            document.getElementById('payment-amount').focus();
        }

        // Hide payment form
        function hidePaymentForm() {
            paymentModal.style.display = 'none';
        }

        // Send mail to supplier
        function sendMailToSupplier(supplierId) {
            const supplier = suppliers.find(s => s.id === supplierId);
            if (!supplier) return;
            
            showComposeMailForm();
            document.getElementById('mail-to').value = supplier.email;
        }

        // View supplier details
        function viewSupplierDetails(supplierId) {
            const supplier = suppliers.find(s => s.id === supplierId);
            if (!supplier) return;
            
            const supplierItems = inventory.filter(item => item.supplierId === supplierId);
            const supplierPaymentsList = supplierPayments.filter(payment => payment.supplierId === supplierId);
            
            let details = `<div class="card">
                <h3>Supplier Details: ${supplier.companyName}</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>Supplier Code</label>
                        <div style="padding: 0.5rem; background-color: var(--light-gray); border-radius: 4px;">${supplier.code}</div>
                    </div>
                    <div class="form-group">
                        <label>Contact Person</label>
                        <div style="padding: 0.5rem; background-color: var(--light-gray); border-radius: 4px;">${supplier.contactPerson}</div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Phone</label>
                        <div style="padding: 0.5rem; background-color: var(--light-gray); border-radius: 4px;">${supplier.phone}</div>
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <div style="padding: 0.5rem; background-color: var(--light-gray); border-radius: 4px;">${supplier.email}</div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Address</label>
                    <div style="padding: 0.5rem; background-color: var(--light-gray); border-radius: 4px;">${supplier.address}</div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Payment Terms</label>
                        <div style="padding: 0.5rem; background-color: var(--light-gray); border-radius: 4px;">Net ${supplier.paymentTerms} days</div>
                    </div>
                    <div class="form-group">
                        <label>Status</label>
                        <div style="padding: 0.5rem; background-color: var(--light-gray); border-radius: 4px; text-transform: capitalize;">${supplier.status}</div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Total Outstanding</label>
                        <div style="padding: 0.5rem; font-size: 1.2rem; font-weight: bold; color: ${supplier.outstandingAmount > 0 ? 'var(--warning)' : 'var(--success)'};">${formatCurrency(supplier.outstandingAmount)}</div>
                    </div>
                    <div class="form-group">
                        <label>Total Purchases</label>
                        <div style="padding: 0.5rem; font-size: 1.2rem; font-weight: bold;">${formatCurrency(supplier.totalPurchases)}</div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Last Payment Date</label>
                        <div style="padding: 0.5rem; background-color: var(--light-gray); border-radius: 4px;">${supplier.lastPaymentDate || 'N/A'}</div>
                    </div>
                    <div class="form-group">
                        <label>Items Supplied</label>
                        <div style="padding: 0.5rem; background-color: var(--light-gray); border-radius: 4px;">${supplier.itemsSupplied}</div>
                    </div>
                </div>
            </div>`;
            
            // Items supplied
            if (supplierItems.length > 0) {
                details += `<div class="card mt-2">
                    <h3>Items Supplied (${supplierItems.length})</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Item Code</th>
                                    <th>Item Name</th>
                                    <th>Category</th>
                                    <th>Invoice No</th>
                                    <th>Quantity</th>
                                    <th>Unit Price</th>
                                    <th>Total Value</th>
                                </tr>
                            </thead>
                            <tbody>`;
                
                supplierItems.forEach(item => {
                    details += `<tr>
                        <td>${item.code}</td>
                        <td>${item.name}</td>
                        <td>${item.category}</td>
                        <td>${item.invoiceNumber || 'N/A'}</td>
                        <td>${item.quantity}</td>
                        <td class="currency">${formatCurrency(item.unitPrice)}</td>
                        <td class="currency">${formatCurrency(item.value)}</td>
                    </tr>`;
                });
                
                details += `</tbody></table></div></div>`;
            }
            
            // Payment history
            if (supplierPaymentsList.length > 0) {
                details += `<div class="card mt-2">
                    <h3>Payment History</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Amount</th>
                                    <th>Method</th>
                                    <th>Reference</th>
                                    <th>Notes</th>
                                </tr>
                            </thead>
                            <tbody>`;
                
                supplierPaymentsList.forEach(payment => {
                    details += `<tr>
                        <td>${payment.date}</td>
                        <td class="currency">${formatCurrency(payment.amount)}</td>
                        <td>${payment.method}</td>
                        <td>${payment.reference}</td>
                        <td>${payment.notes}</td>
                    </tr>`;
                });
                
                details += `</tbody></table></div></div>`;
            }
            
            // Show details in a modal or alert
            const detailModal = document.createElement('div');
            detailModal.className = 'modal';
            detailModal.innerHTML = `
                <div class="modal-content" style="max-width: 800px;">
                    <div class="modal-header">
                        <h3 class="modal-title">Supplier Details</h3>
                        <button class="close-modal">&times;</button>
                    </div>
                    <div style="max-height: 70vh; overflow-y: auto;">
                        ${details}
                    </div>
                    <div class="modal-footer">
                        <button class="secondary" id="close-details-btn">
                            <i class="fas fa-times"></i> Close
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(detailModal);
            detailModal.style.display = 'flex';
            
            detailModal.querySelector('.close-modal').addEventListener('click', () => {
                detailModal.style.display = 'none';
                document.body.removeChild(detailModal);
            });
            
            detailModal.querySelector('#close-details-btn').addEventListener('click', () => {
                detailModal.style.display = 'none';
                document.body.removeChild(detailModal);
            });
            
            // Close when clicking outside
            detailModal.addEventListener('click', (e) => {
                if (e.target === detailModal) {
                    detailModal.style.display = 'none';
                    document.body.removeChild(detailModal);
                }
            });
        }

        // Handle item form submission
        function handleItemSubmit(e) {
            e.preventDefault();
            
            const itemId = document.getElementById('item-id').value;
            const code = document.getElementById('item-code').value.trim();
            const name = document.getElementById('item-name').value.trim();
            const description = document.getElementById('item-description').value.trim();
            const supplierId = parseInt(document.getElementById('item-supplier').value);
            const invoiceNumber = document.getElementById('item-invoice').value.trim();
            const category = document.getElementById('item-category').value;
            const unit = document.getElementById('item-unit').value.trim();
            const unitPrice = parseFloat(document.getElementById('item-unit-price').value);
            const quantity = parseInt(document.getElementById('item-quantity').value);
            const minQuantity = parseInt(document.getElementById('item-min-quantity').value);
            const location = document.getElementById('item-location').value.trim();
            const purchaseDate = document.getElementById('item-purchase-date').value;
            
            // Validation
            if (!code || !name || !unit || isNaN(unitPrice) || isNaN(quantity) || isNaN(minQuantity) || !supplierId) {
                showMessage(errorMessage, 'Please fill all required fields with valid values!');
                return;
            }
            
            if (unitPrice < 0 || quantity < 0 || minQuantity < 0) {
                showMessage(errorMessage, 'Values cannot be negative!');
                return;
            }
            
            const value = quantity * unitPrice;
            
            // Check if item code already exists (for new items only)
            if (!itemId && inventory.some(item => item.code === code)) {
                showMessage(errorMessage, 'Item code already exists! Please use a unique item code.');
                return;
            }
            
            if (itemId) {
                // Edit existing item
                const index = inventory.findIndex(item => item.id === parseInt(itemId));
                if (index !== -1) {
                    inventory[index] = {
                        ...inventory[index],
                        code,
                        name,
                        description,
                        supplierId,
                        invoiceNumber,
                        category: category || inventory[index].category,
                        unit,
                        unitPrice,
                        quantity,
                        minQuantity,
                        location,
                        purchaseDate,
                        value
                    };
                    
                    showMessage(successMessage, 'Item updated successfully!');
                }
            } else {
                // Add new item
                const newId = inventory.length > 0 ? Math.max(...inventory.map(item => item.id)) + 1 : 1;
                inventory.push({
                    id: newId,
                    code,
                    name,
                    description,
                    supplierId,
                    invoiceNumber,
                    category,
                    unit,
                    unitPrice,
                    quantity,
                    minQuantity,
                    location,
                    purchaseDate,
                    value
                });
                
                showMessage(successMessage, 'Item added successfully!');
            }
            
            hideItemForm();
            renderInventory();
            populateIssueItemSelect();
            populateCategoryFilters();
            updateDashboard();
            filterInventory();
        }

        // Handle job form submission
        function handleJobSubmit(e) {
            e.preventDefault();
            
            const jobId = document.getElementById('job-id').value;
            const number = document.getElementById('job-number-input').value.trim();
            const description = document.getElementById('job-description').value.trim();
            const status = document.getElementById('job-status').value;
            
            // Validation
            if (!number) {
                showMessage(jobErrorMessage, 'Job number is required!');
                return;
            }
            
            if (jobId) {
                // Edit existing job
                const index = jobNumbers.findIndex(job => job.id === parseInt(jobId));
                if (index !== -1) {
                    jobNumbers[index] = {
                        ...jobNumbers[index],
                        number,
                        description,
                        status
                    };
                    
                    showMessage(jobSuccessMessage, 'Job updated successfully!');
                }
            } else {
                // Check if job number already exists
                if (jobNumbers.some(job => job.number === number)) {
                    showMessage(jobErrorMessage, 'Job number already exists!');
                    return;
                }
                
                // Add new job
                const newId = jobNumbers.length > 0 ? Math.max(...jobNumbers.map(job => job.id)) + 1 : 1;
                jobNumbers.push({
                    id: newId,
                    number,
                    description,
                    status
                });
                
                showMessage(jobSuccessMessage, 'Job added successfully!');
            }
            
            hideJobForm();
            renderJobNumbers();
            populateJobNumberSelect();
            populateJobFilter();
            updateDashboard();
            filterJobs();
        }

        // Handle supplier form submission
        function handleSupplierSubmit(e) {
            e.preventDefault();
            
            const supplierId = document.getElementById('supplier-id').value;
            const code = document.getElementById('supplier-code').value.trim();
            const companyName = document.getElementById('supplier-company').value.trim();
            const contactPerson = document.getElementById('supplier-contact').value.trim();
            const phone = document.getElementById('supplier-phone').value.trim();
            const email = document.getElementById('supplier-email').value.trim();
            const address = document.getElementById('supplier-address').value.trim();
            const paymentTerms = document.getElementById('supplier-payment-terms').value;
            const status = document.getElementById('supplier-status').value;
            
            // Validation
            if (!code || !companyName || !contactPerson || !phone || !email) {
                showMessage(supplierErrorMessage, 'Please fill all required fields!');
                return;
            }
            
            // Email validation
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                showMessage(supplierErrorMessage, 'Please enter a valid email address!');
                return;
            }
            
            if (supplierId) {
                // Edit existing supplier
                const index = suppliers.findIndex(supplier => supplier.id === parseInt(supplierId));
                if (index !== -1) {
                    suppliers[index] = {
                        ...suppliers[index],
                        code,
                        companyName,
                        contactPerson,
                        phone,
                        email,
                        address,
                        paymentTerms,
                        status
                    };
                    
                    showMessage(supplierSuccessMessage, 'Supplier updated successfully!');
                }
            } else {
                // Check if supplier code already exists
                if (suppliers.some(supplier => supplier.code === code)) {
                    showMessage(supplierErrorMessage, 'Supplier code already exists!');
                    return;
                }
                
                // Check if email already exists
                if (suppliers.some(supplier => supplier.email === email)) {
                    showMessage(supplierErrorMessage, 'Email address already registered!');
                    return;
                }
                
                // Add new supplier
                const newId = suppliers.length > 0 ? Math.max(...suppliers.map(supplier => supplier.id)) + 1 : 1;
                suppliers.push({
                    id: newId,
                    code,
                    companyName,
                    contactPerson,
                    phone,
                    email,
                    address,
                    paymentTerms,
                    status,
                    outstandingAmount: 0.00,
                    totalPurchases: 0.00,
                    lastPaymentDate: null,
                    lastPaymentAmount: 0.00,
                    itemsSupplied: 0,
                    rating: 0
                });
                
                showMessage(supplierSuccessMessage, 'Supplier added successfully!');
            }
            
            hideSupplierForm();
            renderSuppliers();
            populateSupplierFilters();
            populateMailToSelect();
            updateDashboard();
            filterSuppliers();
        }

        // Handle mail submission
        function handleMailSubmit(e) {
            e.preventDefault();
            
            const to = document.getElementById('mail-to').value;
            const subject = document.getElementById('mail-subject').value;
            const body = document.getElementById('mail-body').value;
            
            if (!to || !subject || !body) {
                alert('Please fill all required fields.');
                return;
            }
            
            const newId = mailMessages.length > 0 ? Math.max(...mailMessages.map(mail => mail.id)) + 1 : 1;
            const today = new Date().toISOString().split('T')[0];
            
            // Add to sent folder
            mailMessages.push({
                id: newId,
                folder: 'sent',
                sender: 'John Doe <john.doe@westernairducts.lk>',
                to: to,
                subject: subject,
                body: body,
                date: today,
                read: true,
                important: false,
                attachments: []
            });
            
            // If sending to supplier, also add to suppliers folder
            const isSupplier = suppliers.some(supplier => supplier.email === to);
            if (isSupplier) {
                mailMessages.push({
                    id: newId + 1,
                    folder: 'suppliers',
                    sender: 'John Doe <john.doe@westernairducts.lk>',
                    to: to,
                    subject: subject,
                    body: body,
                    date: today,
                    read: true,
                    important: false,
                    attachments: []
                });
            }
            
            hideComposeMailForm();
            alert('Mail sent successfully!');
            loadMail('sent');
        }

        // Handle payment submission
        function handlePaymentSubmit(e) {
            e.preventDefault();
            
            const supplierId = parseInt(document.getElementById('payment-supplier-id').value);
            const amount = parseFloat(document.getElementById('payment-amount').value);
            const method = document.getElementById('payment-method').value;
            const date = document.getElementById('payment-date').value;
            const reference = document.getElementById('payment-reference').value.trim();
            const notes = document.getElementById('payment-notes').value.trim();
            
            if (!supplierId || isNaN(amount) || amount <= 0) {
                alert('Please enter a valid payment amount.');
                return;
            }
            
            const supplier = suppliers.find(s => s.id === supplierId);
            if (!supplier) {
                alert('Supplier not found.');
                return;
            }
            
            if (amount > supplier.outstandingAmount) {
                alert('Payment amount cannot exceed outstanding amount.');
                return;
            }
            
            // Update supplier outstanding
            supplier.outstandingAmount -= amount;
            supplier.lastPaymentDate = date;
            supplier.lastPaymentAmount = amount;
            
            // Record payment
            const newId = supplierPayments.length > 0 ? Math.max(...supplierPayments.map(payment => payment.id)) + 1 : 1;
            supplierPayments.push({
                id: newId,
                supplierId,
                date,
                amount,
                method,
                reference,
                notes
            });
            
            hidePaymentForm();
            showMessage(supplierSuccessMessage, `Payment of Rs. ${amount.toLocaleString('en-US', {minimumFractionDigits: 2})} recorded successfully!`);
            renderSuppliers();
            updateDashboard();
            filterSuppliers();
        }

        // Handle issue form submission
        function handleIssueSubmit(e) {
            e.preventDefault();
            
            const jobId = parseInt(jobNumberSelect.value);
            const itemId = parseInt(issueItemSelect.value);
            const quantity = parseInt(issueQuantityInput.value);
            const notes = document.getElementById('issue-notes').value.trim();
            
            if (!jobId || !itemId || !quantity) {
                showMessage(issueErrorMessage, 'Please fill all required fields!');
                return;
            }
            
            const job = jobNumbers.find(j => j.id === jobId);
            const item = inventory.find(i => i.id === itemId);
            
            if (!job || !item) {
                showMessage(issueErrorMessage, 'Invalid job or item selected!');
                return;
            }
            
            if (quantity > item.quantity) {
                showMessage(issueErrorMessage, 'Insufficient quantity available!');
                return;
            }
            
            if (quantity <= 0) {
                showMessage(issueErrorMessage, 'Quantity must be greater than 0!');
                return;
            }
            
            // Update inventory
            item.quantity -= quantity;
            item.value = item.quantity * item.unitPrice;
            
            // Add to issue history
            const newId = issueHistory.length > 0 ? Math.max(...issueHistory.map(issue => issue.id)) + 1 : 1;
            const today = new Date().toISOString().split('T')[0];
            
            issueHistory.unshift({
                id: newId,
                date: today,
                jobNumber: job.number,
                itemId: itemId,
                itemCode: item.code,
                itemName: item.name,
                quantity: quantity,
                issuedBy: 'Current User',
                notes: notes
            });
            
            showMessage(issueSuccessMessage, `Successfully issued ${quantity} ${item.unit} of ${item.name} to ${job.number}!`);
            
            // Reset form
            issueForm.reset();
            availableQuantityDiv.textContent = '';
            
            // Update displays
            renderInventory();
            renderIssueHistory();
            populateIssueItemSelect();
            updateDashboard();
            
            // Switch to history tab to show the new entry
            setTimeout(() => {
                activateTab('history');
            }, 1500);
        }

        // Edit item
        function editItem(itemId) {
            const item = inventory.find(i => i.id === itemId);
            if (item) {
                document.getElementById('item-id').value = item.id;
                document.getElementById('item-code').value = item.code;
                document.getElementById('item-name').value = item.name;
                document.getElementById('item-description').value = item.description;
                document.getElementById('item-supplier').value = item.supplierId;
                document.getElementById('item-invoice').value = item.invoiceNumber;
                document.getElementById('item-category').value = item.category;
                document.getElementById('item-unit').value = item.unit;
                document.getElementById('item-unit-price').value = item.unitPrice;
                document.getElementById('item-quantity').value = item.quantity;
                document.getElementById('item-min-quantity').value = item.minQuantity;
                document.getElementById('item-location').value = item.location;
                document.getElementById('item-purchase-date').value = item.purchaseDate || new Date().toISOString().split('T')[0];
                
                itemModal.style.display = 'flex';
            }
        }

        // Delete item
        function deleteItem(itemId) {
            if (confirm('Are you sure you want to delete this item? This action cannot be undone.')) {
                inventory = inventory.filter(item => item.id !== itemId);
                renderInventory();
                populateIssueItemSelect();
                updateDashboard();
                showMessage(successMessage, 'Item deleted successfully!');
                filterInventory();
            }
        }

        // Edit job
        function editJob(jobId) {
            const job = jobNumbers.find(j => j.id === jobId);
            if (job) {
                document.getElementById('job-id').value = job.id;
                document.getElementById('job-number-input').value = job.number;
                document.getElementById('job-description').value = job.description;
                document.getElementById('job-status').value = job.status;
                
                jobModal.style.display = 'flex';
            }
        }

        // Delete job
        function deleteJob(jobId) {
            if (confirm('Are you sure you want to delete this job? This action cannot be undone.')) {
                // Check if job has issue history
                const job = jobNumbers.find(j => j.id === jobId);
                if (job && issueHistory.some(issue => issue.jobNumber === job.number)) {
                    if (!confirm('This job has issue history. Are you sure you want to delete it?')) {
                        return;
                    }
                }
                
                jobNumbers = jobNumbers.filter(job => job.id !== jobId);
                renderJobNumbers();
                populateJobNumberSelect();
                populateJobFilter();
                updateDashboard();
                showMessage(jobSuccessMessage, 'Job deleted successfully!');
                filterJobs();
            }
        }

        // Edit supplier
        function editSupplier(supplierId) {
            const supplier = suppliers.find(s => s.id === supplierId);
            if (supplier) {
                document.getElementById('supplier-id').value = supplier.id;
                document.getElementById('supplier-code').value = supplier.code;
                document.getElementById('supplier-company').value = supplier.companyName;
                document.getElementById('supplier-contact').value = supplier.contactPerson;
                document.getElementById('supplier-phone').value = supplier.phone;
                document.getElementById('supplier-email').value = supplier.email;
                document.getElementById('supplier-address').value = supplier.address;
                document.getElementById('supplier-payment-terms').value = supplier.paymentTerms;
                document.getElementById('supplier-status').value = supplier.status;
                
                supplierModal.style.display = 'flex';
            }
        }

        // Delete supplier
        function deleteSupplier(supplierId) {
            if (confirm('Are you sure you want to delete this supplier? This action cannot be undone.')) {
                // Check if supplier has items
                const supplier = suppliers.find(s => s.id === supplierId);
                if (supplier && inventory.some(item => item.supplierId === supplierId)) {
                    if (!confirm('This supplier has items in inventory. Are you sure you want to delete?')) {
                        return;
                    }
                }
                
                suppliers = suppliers.filter(supplier => supplier.id !== supplierId);
                renderSuppliers();
                populateSupplierFilters();
                populateMailToSelect();
                updateDashboard();
                showMessage(supplierSuccessMessage, 'Supplier deleted successfully!');
                filterSuppliers();
            }
        }

        // Filter inventory items
        function filterInventory() {
            const searchTerm = inventorySearch.value.toLowerCase();
            const categoryFilter = inventoryCategoryFilter.value;
            const supplierFilter = inventorySupplierFilter.value;
            const statusFilter = inventoryStatusFilter.value;
            
            let filteredItems = inventory;
            
            // Apply text search
            if (searchTerm) {
                filteredItems = filteredItems.filter(item => 
                    item.code.toLowerCase().includes(searchTerm) ||
                    item.name.toLowerCase().includes(searchTerm) ||
                    (item.category && item.category.toLowerCase().includes(searchTerm)) ||
                    (item.location && item.location.toLowerCase().includes(searchTerm)) ||
                    (item.invoiceNumber && item.invoiceNumber.toLowerCase().includes(searchTerm)) ||
                    (item.supplierId && suppliers.find(s => s.id === item.supplierId && s.companyName.toLowerCase().includes(searchTerm)))
                );
            }
            
            // Apply category filter
            if (categoryFilter) {
                filteredItems = filteredItems.filter(item => item.category === categoryFilter);
            }
            
            // Apply supplier filter
            if (supplierFilter) {
                filteredItems = filteredItems.filter(item => item.supplierId === parseInt(supplierFilter));
            }
            
            // Apply status filter
            if (statusFilter) {
                if (statusFilter === 'low') {
                    filteredItems = filteredItems.filter(item => item.quantity <= item.minQuantity);
                } else if (statusFilter === 'ok') {
                    filteredItems = filteredItems.filter(item => item.quantity > item.minQuantity);
                }
            }
            
            renderInventory(filteredItems);
            
            // Update results info
            if (filteredItems.length === inventory.length) {
                inventoryResultsInfo.textContent = `Showing all ${inventory.length} items`;
            } else {
                inventoryResultsInfo.textContent = `Showing ${filteredItems.length} of ${inventory.length} items`;
            }
        }

        // Clear inventory filters
        function clearInventoryFilters() {
            inventorySearch.value = '';
            inventoryCategoryFilter.value = '';
            inventorySupplierFilter.value = '';
            inventoryStatusFilter.value = '';
            filterInventory();
        }

        // Filter issue items
        function filterIssueItems() {
            const searchTerm = issueItemSearch.value.toLowerCase();
            const categoryFilter = issueCategoryFilter.value;
            
            let filteredItems = inventory;
            
            // Apply text search
            if (searchTerm) {
                filteredItems = filteredItems.filter(item => 
                    item.code.toLowerCase().includes(searchTerm) ||
                    item.name.toLowerCase().includes(searchTerm) ||
                    (item.supplierId && suppliers.find(s => s.id === item.supplierId && s.companyName.toLowerCase().includes(searchTerm)))
                );
            }
            
            // Apply category filter
            if (categoryFilter) {
                filteredItems = filteredItems.filter(item => item.category === categoryFilter);
            }
            
            // Update the issue item dropdown
            issueItemSelect.innerHTML = '<option value="">Select Item</option>';
            
            filteredItems.forEach(item => {
                const option = document.createElement('option');
                option.value = item.id;
                option.textContent = `${item.code} - ${item.name} (${item.quantity} available)`;
                issueItemSelect.appendChild(option);
            });
        }

        // Clear issue filters
        function clearIssueFilters() {
            issueItemSearch.value = '';
            issueCategoryFilter.value = '';
            populateIssueItemSelect();
        }

        // Filter jobs
        function filterJobs() {
            const searchTerm = jobSearch.value.toLowerCase();
            const statusFilter = jobStatusFilter.value;
            
            let filteredJobs = jobNumbers;
            
            // Apply text search
            if (searchTerm) {
                filteredJobs = filteredJobs.filter(job => 
                    job.number.toLowerCase().includes(searchTerm) ||
                    (job.description && job.description.toLowerCase().includes(searchTerm))
                );
            }
            
            // Apply status filter
            if (statusFilter) {
                filteredJobs = filteredJobs.filter(job => job.status === statusFilter);
            }
            
            renderJobNumbers(filteredJobs);
            
            // Update results info
            if (filteredJobs.length === jobNumbers.length) {
                jobResultsInfo.textContent = `Showing all ${jobNumbers.length} jobs`;
            } else {
                jobResultsInfo.textContent = `Showing ${filteredJobs.length} of ${jobNumbers.length} jobs`;
            }
        }

        // Clear job filters
        function clearJobFilters() {
            jobSearch.value = '';
            jobStatusFilter.value = '';
            filterJobs();
        }

        // Filter suppliers
        function filterSuppliers() {
            const searchTerm = supplierSearch.value.toLowerCase();
            const statusFilter = supplierStatusFilter.value;
            
            let filteredSuppliers = suppliers;
            
            // Apply text search
            if (searchTerm) {
                filteredSuppliers = filteredSuppliers.filter(supplier => 
                    supplier.code.toLowerCase().includes(searchTerm) ||
                    supplier.companyName.toLowerCase().includes(searchTerm) ||
                    supplier.contactPerson.toLowerCase().includes(searchTerm) ||
                    supplier.email.toLowerCase().includes(searchTerm) ||
                    supplier.phone.toLowerCase().includes(searchTerm)
                );
            }
            
            // Apply status filter
            if (statusFilter) {
                if (statusFilter === 'active') {
                    filteredSuppliers = filteredSuppliers.filter(supplier => supplier.status === 'active');
                } else if (statusFilter === 'inactive') {
                    filteredSuppliers = filteredSuppliers.filter(supplier => supplier.status === 'inactive');
                } else if (statusFilter === 'overdue') {
                    filteredSuppliers = filteredSuppliers.filter(supplier => supplier.outstandingAmount > 0);
                } else if (statusFilter === 'paid') {
                    filteredSuppliers = filteredSuppliers.filter(supplier => supplier.outstandingAmount <= 0);
                }
            }
            
            renderSuppliers(filteredSuppliers);
            
            // Update results info
            if (filteredSuppliers.length === suppliers.length) {
                supplierResultsInfo.textContent = `Showing all ${suppliers.length} suppliers`;
            } else {
                supplierResultsInfo.textContent = `Showing ${filteredSuppliers.length} of ${suppliers.length} suppliers`;
            }
        }

        // Clear supplier filters
        function clearSupplierFilters() {
            supplierSearch.value = '';
            supplierStatusFilter.value = '';
            filterSuppliers();
        }

        // Search issue history
        function searchHistory() {
            const searchTerm = historySearch.value.toLowerCase();
            const dateFrom = historyDateFrom.value;
            const dateTo = historyDateTo.value;
            
            let filteredHistory = issueHistory;
            
            // Apply text search
            if (searchTerm) {
                filteredHistory = filteredHistory.filter(issue => 
                    issue.jobNumber.toLowerCase().includes(searchTerm) || 
                    issue.itemName.toLowerCase().includes(searchTerm) ||
                    issue.itemCode.toLowerCase().includes(searchTerm) ||
                    (issue.notes && issue.notes.toLowerCase().includes(searchTerm))
                );
            }
            
            // Apply date filters
            if (dateFrom) {
                filteredHistory = filteredHistory.filter(issue => issue.date >= dateFrom);
            }
            
            if (dateTo) {
                filteredHistory = filteredHistory.filter(issue => issue.date <= dateTo);
            }
            
            renderIssueHistory(filteredHistory);
            
            // Update results info
            if (filteredHistory.length === issueHistory.length) {
                historyResultsInfo.textContent = `Showing all ${issueHistory.length} records`;
            } else {
                historyResultsInfo.textContent = `Showing ${filteredHistory.length} of ${issueHistory.length} records`;
            }
        }

        // Clear history search
        function clearHistorySearch() {
            historySearch.value = '';
            historyDateFrom.value = '';
            historyDateTo.value = '';
            renderIssueHistory();
            historyResultsInfo.textContent = `Showing all ${issueHistory.length} records`;
        }

        // Generate report
        function generateReport() {
            const reportType = document.getElementById('report-type').value;
            const dateFrom = document.getElementById('date-from').value;
            const dateTo = document.getElementById('date-to').value;
            const jobFilter = document.getElementById('job-filter').value;
            
            let reportData = '';
            
            switch(reportType) {
                case 'inventory':
                    reportData = generateInventoryReport();
                    break;
                case 'issuance':
                    reportData = generateIssuanceReport(dateFrom, dateTo, jobFilter);
                    break;
                case 'job-usage':
                    reportData = generateJobUsageReport(dateFrom, dateTo);
                    break;
                case 'low-stock':
                    reportData = generateLowStockReport();
                    break;
                case 'stock-value':
                    reportData = generateStockValueReport();
                    break;
                case 'supplier-outstanding':
                    reportData = generateSupplierOutstandingReport();
                    break;
                case 'supplier-performance':
                    reportData = generateSupplierPerformanceReport();
                    break;
            }
            
            reportResults.innerHTML = reportData;
            
            // Show placeholder for chart
            document.getElementById('chart-placeholder').style.display = 'block';
        }

        // Generate inventory report
        function generateInventoryReport() {
            let html = '<div class="card"><h3>Inventory Summary Report</h3>';
            html += '<div class="table-container"><table><thead><tr><th>Code</th><th>Name</th><th>Category</th><th>Supplier</th><th>Invoice No</th><th>Unit</th><th>Unit Price</th><th>Quantity</th><th>Min Qty</th><th>Location</th><th>Status</th><th>Value</th></tr></thead><tbody>';
            
            inventory.forEach(item => {
                const statusClass = item.quantity <= item.minQuantity ? 'status-low' : 'status-ok';
                const statusText = item.quantity <= item.minQuantity ? 'Low Stock' : 'In Stock';
                const supplier = suppliers.find(s => s.id === item.supplierId);
                const supplierName = supplier ? supplier.companyName : 'Unknown';
                
                html += `<tr>
                    <td>${item.code}</td>
                    <td>${item.name}</td>
                    <td>${item.category}</td>
                    <td>${supplierName}</td>
                    <td>${item.invoiceNumber || 'N/A'}</td>
                    <td>${item.unit}</td>
                    <td class="currency">${formatCurrency(item.unitPrice)}</td>
                    <td>${item.quantity}</td>
                    <td>${item.minQuantity}</td>
                    <td>${item.location}</td>
                    <td><span class="status ${statusClass}">${statusText}</span></td>
                    <td class="currency">${formatCurrency(item.value)}</td>
                </tr>`;
            });
            
            html += '</tbody></table></div></div>';
            
            return html;
        }

        // Generate issuance report
        function generateIssuanceReport(dateFrom, dateTo, jobFilter) {
            let filteredHistory = [...issueHistory];
            
            if (dateFrom) {
                filteredHistory = filteredHistory.filter(issue => issue.date >= dateFrom);
            }
            
            if (dateTo) {
                filteredHistory = filteredHistory.filter(issue => issue.date <= dateTo);
            }
            
            if (jobFilter) {
                const job = jobNumbers.find(j => j.id === parseInt(jobFilter));
                if (job) {
                    filteredHistory = filteredHistory.filter(issue => issue.jobNumber === job.number);
                }
            }
            
            let html = `<div class="card"><h3>Item Issuance Report</h3>`;
            if (dateFrom || dateTo) {
                html += `<p>Period: ${dateFrom || 'Start'} to ${dateTo || 'End'}</p>`;
            }
            
            html += '<div class="table-container"><table><thead><tr><th>Date</th><th>Job Number</th><th>Item Code</th><th>Item Name</th><th>Quantity</th><th>Issued By</th></tr></thead><tbody>';
            
            filteredHistory.forEach(issue => {
                html += `<tr>
                    <td>${issue.date}</td>
                    <td>${issue.jobNumber}</td>
                    <td>${issue.itemCode}</td>
                    <td>${issue.itemName}</td>
                    <td>${issue.quantity}</td>
                    <td>${issue.issuedBy}</td>
                </tr>`;
            });
            
            html += '</tbody></table></div></div>';
            
            return html;
        }

        // Generate job usage report
        function generateJobUsageReport(dateFrom, dateTo) {
            let filteredHistory = [...issueHistory];
            
            if (dateFrom) {
                filteredHistory = filteredHistory.filter(issue => issue.date >= dateFrom);
            }
            
            if (dateTo) {
                filteredHistory = filteredHistory.filter(issue => issue.date <= dateTo);
            }
            
            const jobUsage = {};
            
            filteredHistory.forEach(issue => {
                if (!jobUsage[issue.jobNumber]) {
                    jobUsage[issue.jobNumber] = {
                        items: 0,
                        quantity: 0
                    };
                }
                
                jobUsage[issue.jobNumber].items++;
                jobUsage[issue.jobNumber].quantity += issue.quantity;
            });
            
            let html = `<div class="card"><h3>Job Usage Report</h3>`;
            if (dateFrom || dateTo) {
                html += `<p>Period: ${dateFrom || 'Start'} to ${dateTo || 'End'}</p>`;
            }
            
            html += '<div class="table-container"><table><thead><tr><th>Job Number</th><th>Items Issued</th><th>Total Quantity</th></tr></thead><tbody>';
            
            Object.keys(jobUsage).forEach(jobNumber => {
                html += `<tr>
                    <td>${jobNumber}</td>
                    <td>${jobUsage[jobNumber].items}</td>
                    <td>${jobUsage[jobNumber].quantity}</td>
                </tr>`;
            });
            
            html += '</tbody></table></div></div>';
            
            return html;
        }

        // Generate low stock report
        function generateLowStockReport() {
            const lowStockItems = inventory.filter(item => item.quantity <= item.minQuantity);
            
            let html = '<div class="card"><h3>Low Stock Alert Report</h3>';
            html += '<div class="table-container"><table><thead><tr><th>Item Code</th><th>Item Name</th><th>Category</th><th>Supplier</th><th>Unit</th><th>Current Quantity</th><th>Minimum Quantity</th><th>Location</th></tr></thead><tbody>';
            
            lowStockItems.forEach(item => {
                const supplier = suppliers.find(s => s.id === item.supplierId);
                const supplierName = supplier ? supplier.companyName : 'Unknown';
                
                html += `<tr>
                    <td>${item.code}</td>
                    <td>${item.name}</td>
                    <td>${item.category}</td>
                    <td>${supplierName}</td>
                    <td>${item.unit}</td>
                    <td class="status-low">${item.quantity}</td>
                    <td>${item.minQuantity}</td>
                    <td>${item.location}</td>
                </tr>`;
            });
            
            html += '</tbody></table></div></div>';
            
            return html;
        }

        // Generate stock value report
        function generateStockValueReport() {
            const totalValue = inventory.reduce((sum, item) => sum + (item.value || 0), 0);
            
            let html = '<div class="card"><h3>Stock Value Report</h3>';
            html += `<p><strong>Total Stock Value: ${formatCurrency(totalValue)}</strong></p>`;
            html += '<div class="table-container"><table><thead><tr><th>Category</th><th>Total Value</th><th>Percentage</th></tr></thead><tbody>';
            
            const categoryValues = {};
            inventory.forEach(item => {
                if (!categoryValues[item.category]) {
                    categoryValues[item.category] = 0;
                }
                categoryValues[item.category] += item.value || 0;
            });
            
            Object.keys(categoryValues).forEach(category => {
                const percentage = ((categoryValues[category] / totalValue) * 100).toFixed(2);
                html += `<tr>
                    <td>${category}</td>
                    <td class="currency">${formatCurrency(categoryValues[category])}</td>
                    <td>${percentage}%</td>
                </tr>`;
            });
            
            html += '</tbody></table></div></div>';
            
            return html;
        }

        // Generate supplier outstanding report
        function generateSupplierOutstandingReport() {
            const suppliersWithOutstanding = suppliers.filter(s => s.outstandingAmount > 0);
            const totalOutstanding = suppliersWithOutstanding.reduce((sum, s) => sum + s.outstandingAmount, 0);
            
            let html = '<div class="card"><h3>Supplier Outstanding Report</h3>';
            html += `<p><strong>Total Outstanding: ${formatCurrency(totalOutstanding)}</strong></p>`;
            html += '<div class="table-container"><table><thead><tr><th>Supplier Code</th><th>Company Name</th><th>Contact Person</th><th>Phone</th><th>Outstanding Amount</th><th>Last Payment Date</th><th>Status</th></tr></thead><tbody>';
            
            suppliersWithOutstanding.forEach(supplier => {
                html += `<tr>
                    <td>${supplier.code}</td>
                    <td>${supplier.companyName}</td>
                    <td>${supplier.contactPerson}</td>
                    <td>${supplier.phone}</td>
                    <td class="currency outstanding-amount outstanding-due">${formatCurrency(supplier.outstandingAmount)}</td>
                    <td>${supplier.lastPaymentDate || 'N/A'}</td>
                    <td><span class="status status-overdue">Payment Due</span></td>
                </tr>`;
            });
            
            html += '</tbody></table></div></div>';
            
            return html;
        }

        // Generate supplier performance report
        function generateSupplierPerformanceReport() {
            let html = '<div class="card"><h3>Supplier Performance Report</h3>';
            html += '<div class="table-container"><table><thead><tr><th>Supplier</th><th>Items Supplied</th><th>Total Purchases</th><th>Outstanding</th><th>Avg Delivery Time</th><th>Quality Rating</th><th>Performance</th></tr></thead><tbody>';
            
            suppliers.forEach(supplier => {
                const supplierItems = inventory.filter(item => item.supplierId === supplier.id);
                const performance = supplier.rating >= 4.5 ? 'Excellent' : 
                                  supplier.rating >= 4.0 ? 'Good' : 
                                  supplier.rating >= 3.5 ? 'Average' : 'Poor';
                const performanceClass = supplier.rating >= 4.5 ? 'status-ok' : 
                                       supplier.rating >= 4.0 ? 'status' : 
                                       supplier.rating >= 3.5 ? 'status-low' : 'status-overdue';
                
                html += `<tr>
                    <td>${supplier.companyName}</td>
                    <td>${supplierItems.length}</td>
                    <td class="currency">${formatCurrency(supplier.totalPurchases)}</td>
                    <td class="currency">${formatCurrency(supplier.outstandingAmount)}</td>
                    <td>3 days</td>
                    <td>${supplier.rating}/5.0</td>
                    <td><span class="status ${performanceClass}">${performance}</span></td>
                </tr>`;
            });
            
            html += '</tbody></table></div></div>';
            
            return html;
        }

        // Save user preferences
        function saveUserPreferences(e) {
            e.preventDefault();
            showMessage(dbSuccessMessage, 'User preferences saved successfully!');
        }

        // Save system configuration
        function saveSystemConfig(e) {
            e.preventDefault();
            showMessage(dbSuccessMessage, 'System configuration saved successfully!');
        }

        // Backup database
        function backupDatabase() {
            showMessage(dbSuccessMessage, 'Database backup completed successfully!');
        }

        // Restore database
        function restoreDatabase() {
            if (confirm('Are you sure you want to restore the database? This will overwrite current data.')) {
                showMessage(dbSuccessMessage, 'Database restored successfully!');
            }
        }

        // Clear all data
        function clearAllData() {
            if (confirm('WARNING: This will permanently delete all data. Are you absolutely sure?')) {
                if (confirm('This action cannot be undone. Type "DELETE" to confirm.')) {
                    // In a real app, this would clear the data
                    showMessage(dbSuccessMessage, 'All data has been cleared!');
                }
            }
        }

        // Perform logout
        function performLogout() {
            alert('You have been logged out successfully!');
            logoutModal.style.display = 'none';
            // In a real app, this would redirect to login page
            // window.location.href = 'login.html';
        }

        // Show message
        function showMessage(element, message) {
            element.textContent = message;
            element.style.display = 'flex';
            
            setTimeout(() => {
                element.style.display = 'none';
            }, 3000);
        }
    </script>
</body>
</html>

